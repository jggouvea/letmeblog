<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="José Geraldo Gouvêa" />
  <title>Blogging With Markdown and Pandoc</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 50em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {  background-color: #f8f8f8; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ef2929; } /* Alert */
    code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #c4a000; } /* Attribute */
    code span.bn { color: #0000cf; } /* BaseN */
    code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4e9a06; } /* Char */
    code span.cn { color: #000000; } /* Constant */
    code span.co { color: #8f5902; font-style: italic; } /* Comment */
    code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
    code span.dt { color: #204a87; } /* DataType */
    code span.dv { color: #0000cf; } /* DecVal */
    code span.er { color: #a40000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #0000cf; } /* Float */
    code span.fu { color: #000000; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
    code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
    code span.ot { color: #8f5902; } /* Other */
    code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
    code span.sc { color: #000000; } /* SpecialChar */
    code span.ss { color: #4e9a06; } /* SpecialString */
    code span.st { color: #4e9a06; } /* String */
    code span.va { color: #000000; } /* Variable */
    code span.vs { color: #4e9a06; } /* VerbatimString */
    code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Blogging With Markdown and Pandoc</h1>
<p class="subtitle">Posting content from markdown files with shell scripts</p>
<p class="author">José Geraldo Gouvêa</p>
<p class="date">April 23th, 2021.</p>
</header>
<nav id="TOC" role="doc-toc">

</nav>
<h1 id="introduction">Introduction</h1>
<p>From early 2010 to early 2021 I had a blog titled “Letras Elétricas”, built upon WordPress, hosted at <a href="http://www.letraseletricas.blog.br" class="uri">http://www.letraseletricas.blog.br</a>, but I have recently been forced to ditch that reputable and foolproof <a href="https://en.wikipedia.org/wiki/Content_management_system">CMS</a> because it had become an ordeal to keep the website going. When I had to find another way to build and keep my site, I suddenly found that the existing solutions didn’t cater to my needs, so I was pressured to build my own tool, despite the fact that I am not proficient in programming and barely know the basics of shell scripting.</p>
<p>However, witness to the power of shell scripting, I was able to create my personal solution to blogging, which, in spite of being rather limited, can actually do what I needed the most: posts, fixed pages, categories, tags, archives, news feed, sitemap and dynamic landing page. That solution is this set of scripts which I have named <code>letmeblog</code>.</p>
<p>This document describes how I wrote these scripts, how they work and how they can be improved by the deft hands of someone who may know better.</p>
<h2 id="original-inspiration">Original inspiration</h2>
<p>The creation of <code>letmeblog</code> was inspired by the work of one <a href="https://github.com/jillesvangurp">Jilles van Gurp</a>, a Belgian programmer who bravely exported his WordPress blog into a set of <a href="http://markdownguide.org">Markdown</a> files because he wasn’t pleased with the way WordPress was handling his writing. He later found a way to convert his posts and pages to static HTML using <a href="http://www.pandoc.org">Pandoc</a> by John Mac Farlane. Everything I did was follow his footsteps, though, in all fairness, I had a rougher path to tread and a longer distance to cover:</p>
<ul>
<li>Jilles’ website features less than 100 pages and posts, while mine had a whooping 910 — which I eventually reduced to 810 by merging, deleting or archiving posts.</li>
<li>Back in 2010, when he exported his blog, there were WordPress plug-ins which handled importing, editing and exporting Markdown from within the Control Panel itself; but these have either been deleted from the plug-in database, become incompatible with newer WordPress versions or simply been abandoned by their creators.</li>
<li>When I finally made my mind that I must move away from WordPress; my blog was already faulty, unstable and dangerously heavyweight — it wasn’t easy to recover a recent and decent XML backup including all recent posts and comments, as my previous export file was missing some.</li>
<li>Jilles’ goals didn’t include sorting posts by categories or tags, nor did he mean to build neat post archive pages, so he could make do with fewer scripts and fewer pre and post processing of his source files.</li>
</ul>
<h2 id="why-the-name">Why the name</h2>
<p>The name <code>LEtmeblog</code> was chosen as an acronym for “Letras Elétricas markdown blog”, in which “Letras Elétricas” is the name of <a href="https://www.letraseletricas.blog.br">my personal weblog</a>, for which I have written these compilation scripts, and the letter “e” was only added for <a href="https://literarydevices.net/euphony">euphony</a>.</p>
<h2 id="a-note-about-philosophy">A note about philosophy</h2>
<p>Most people want to have <strong>automated</strong> tools to perform tasks for them. Automation is cool and useful, of course, and I, myself, am the user of many such automated tools. However, when I am dealing with creative content, I happily give up automation for:</p>
<ol type="1">
<li><strong>Control</strong>,</li>
<li>Modularity,</li>
<li>Flexibility,</li>
<li><strong>Speed</strong>.</li>
</ol>
<p>Retaking control of my content was one of the key reasons why I left WordPress and eventually decided to create my own blogging way, after briefly trying alternatives like <a href="https://jekyllrb.com">Jekyll</a>, <a href="https://blog.getpelican.com">Pelican</a> and <a href="https://www.getzola.org">Zola</a>.</p>
<p>With WordPress, I was always under the impression that my content was locked up in a binary format (SQL database) prone to binary corruption and requiring frequent backups which used a lot of bandwidth and generated big downloads. Some of the tools to back up the database were proprietary or even required payment, and none of them gave me actual control of my content.</p>
<p>This situation worsened after WordPress became incompatible with a number of old plug-ins which allowed easy Markdown import and export, or even storage of content in Markdown format. The new “Gutenberg” editor rubbed salt onto the wound, as it was now impossible to simply write my content elsewhere and paste it into the editor.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Content lock-up is apparently becoming a trend, even in so-called “Open Source” software, like WordPress. And that’s intollerable because I want to keep my content <em>mine</em> in the first place.</p>
<p>Another problem with WordPress blogs, which seems to be replicated in many other platforms, including some that purport to use Markdown inputs, is that you don’t actually control the process by which the source file becomes a blog. There is a template, there are scripts you will host or run and there are some source files to be processed — but the actual conversion isn’t transparent and you can’t interfere easily with it.</p>
<p><code>letmeblog</code> addresses these concerns by splitting the generation of the website in a set of scripts which can all be run separately, giving you control of what you are generating in each step. Moreover, by allowing you to stop and restart compilation at any time, it saves you time and processing power as you can prevent the full execution of a command that will <em>not</em> generate your site cleanly.</p>
<p>Nowadays website content is <em>generated</em> from source files, that’s the way things are done. Source files can be reused for the production of different outputs, or for inclusion in other source files. In a traditional blog your content is rarely ever reusable. In fact, if you want to generate e-books or PDFs from your content, you have to keep a separate source file offline, in your computer, which creates a permanent problem with versioning.</p>
<p>With <code>letmeblog</code> you keep your content conveniently stored in Markdown files, which you can reprocess to create different HTML versions, as well as producing EPUB, PDF or even MS Word versions, if need arises. You can keep your files versioned using <code>git</code> and you can write scripts to recombine or split your source files to produce different outputs.</p>
<p>And finally there is the problem of <strong>speed</strong>, which was my second biggest concern about WordPress, as my blog was growing ever slower as it grew in size. Every new page or post I added seemed to increase the performance overhead, as the database had to be queried multiple times by the server. As more visitors came, server overhead made the site unusable for long periods of time, causing my visitor count to drop from almos 200 a day to less than 70.</p>
<p>A static website has no such issues. Pages are served super-quickly as there is little processing to be done server-side. Granted, I have lost the ability to actually track my visitors, or to store their comments, but both are blessings in disguise — especially that about comments, as most of these were spam anyway, and legit commentators often left garbage remarks which added little to the actual content. Social networks have largely replaced fora and comment systems, so there’s no point trying to keep such things in my blog.</p>
<p>Very soon people will regard comment systems more or less like “<a href="https://en.wikipedia.org/wiki/Guestbook">guestbooks</a>”, which used to be all the rage around the turn of the century, but are now some relic that no cool website actually uses prominently.</p>
<p>As for visitor count, social network impact is a much more useful thing to measure. It doesn’t matter, in terms of relevance, that 200-odd people have stumbled upon your site if most of them have not stayed and fewer will ever return.</p>
<p>Therefore, <code>letmeblog</code>, though it goes back to the olden days of static websites, is not actually dropping much in terms of actual usability. It only needs to be improved with new features (like page navigation, which is still sorely missing).</p>
<h2 id="licensing-issues">Licensing issues</h2>
<p><em>Most</em> of my scripts are <em>inspired</em> by Jilles’, but not identical to them. The exceptions are <code>do_atom.sh</code> and <code>do_sitemap.sh</code>, both of which are almost identical to Jilles’ originals.</p>
<p>All in all, Jilles’ site is compiled by a few commands he invokes from a <code>Makefile</code> (which I have opted not to use), while my blog is compiled by a set of fourteen separated scripts, which have to be run separately. I have developed my own scripts for most of the tasks and the similarities to be found don’t result from plagiarism, but from the very nature of Pandoc, which takes a limited set of command-line arguments. Even the template I use has been heavily modified from Pandoc’s own HTML template, with a few hints taken from Jilles’ template.</p>
<p>I do recognise that I have <em>built upon</em> his work, and for that I duly give him credit, but I owe about as much to <a href="https://stackoverflow.com">Stackexchange</a>… if you know what I mean. Anyway, Jilles kindly put his work under the <a href="https://mit-license.org/">MIT/Expat license</a>, which is a <a href="https://www.gnu.org/licenses/copyleft.html">copyleft</a> license. Out of my own will, I would have rather used the <a href="https://www.gnu.org/licenses/licenses.html">GPL</a>, but, since Expat and GPL are compatible, it makes sense to keep his choice. Therefore, the scripts are provided under the MIT/Expat license, even the parts I developed autonomously.</p>
<h1 id="scripts">Scripts</h1>
<p>The blog building system is made up of fourteen shell scripts, which you will put into a <code>scripts</code> directory under the build root:</p>
<ol type="1">
<li><code>get_cats.sh</code></li>
<li><code>get_tags.sh</code></li>
<li><code>get_years.sh</code></li>
<li><code>set_recent.sh</code></li>
<li><code>set_pinned.sh</code></li>
<li><code>do_home.sh</code></li>
<li><code>do_cats.sh</code></li>
<li><code>do_tags.sh</code></li>
<li><code>do_pages.sh</code></li>
<li><code>do_posts.sh</code></li>
<li><code>do_blogfull.sh</code></li>
<li><code>do_archives.sh</code></li>
<li><code>do_atom.sh</code></li>
<li><code>do_sitemap.sh</code></li>
</ol>
<p>Scripts up to #5 are preprocessing steps (the first don’t have to be run every time you update the blog).</p>
<p>Scripts from #6 to #12 are compilation steps and should be always run whenever you: - Create a new post; - Categorise to a post; - Tag a post; - Remove a post from a category; - Remove a tag from a post; - Create a new tag or delete one that existed; - Create a new category or delete one that existed.</p>
<p>If you are unsure about the order you should run the scripts, you can use the mnemonic: “get, set, do”. Never run a “set” script before you have run the “get” ones and never run a “do” script before running a “set” script. “Get” scripts only need to be run when you first build the blog, after that you can maintain them by hand. “Set” scripts only need to be run when you add new content. “Do” scripts need to be run every time.</p>
<p>Unless otherwise specified, the scripts don’t take arguments nor have options. Simply run them from the build root:<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><code>sh scripts/do_home.sh</code></p>
<p>Other than that, you have some extra scripts, for specific purposes:</p>
<ol type="1">
<li><code>update_post.sh</code></li>
<li><code>update_template.sh</code></li>
</ol>
<p><code>update_post.sh</code> is to recompile one single post, if you notice some problem specific to it.</p>
<p>Usage: <code>sh scripts/update_post.sh src/posts/XXXX-XX-XX-postname.md</code></p>
<p>The script will silently and gently generate the HTML output in the <code>posts/</code> directory.</p>
<p><code>update_template.sh</code> is to regenerate the HTML template if you make changes to its parts. You will know why this is useful later in this document.</p>
<h1 id="requirements">Requirements</h1>
<p>The scripts are quite simple and will probably work in any Linux distribution, as well as any POSIX-compliant operating system which features the packages listed below:</p>
<dl>
<dt>Pandoc</dt>
<dd>for markdown compilation;
</dd>
<dt><code>bash</code></dt>
<dd>to actually execute the commands;<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</dd>
</dl>
<dl>
<dt>GNU “coreutils”</dt>
<dd>for source files preprocessing;
</dd>
<dt><code>jq</code></dt>
<dd>to extract metadata from Markdown files;
</dd>
<dt>GNU <code>sed</code></dt>
<dd>for source file preprocessing and for some HTML post processing as well;<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>
</dd>
</dl>
<p>From “coreutils”, the commands actually used in the script are <code>basename</code>, <code>cat</code>, <code>column</code>, <code>cp</code>, <code>cut</code>, <code>date</code>, <code>echo</code>, <code>find</code>, <code>grep</code>, <code>ls</code>, <code>mkdir</code>, <code>mv</code>, <code>paste</code>, <code>printf</code>, <code>readlink</code>, <code>rm</code>, <code>seq</code>, <code>sort</code>, <code>source</code>, <code>stat</code>, <code>tail</code>, <code>tr</code>, <code>uniq</code> and <code>wc</code>.</p>
<p>Users of lightweight distributions of Linux (like Slitaz and Tiny Core) might not be able to run these scripts, as these distros ship “busybox” as a replacement for Coreutils, but your mileage may vary.</p>
<h1 id="blog-structure">Blog structure</h1>
<p>Before you begin using the script you have to feed it content in a predictable way. This is not a “smart” content management system like WordPress and others: these scripts are only as “smart” as the user (and their creator). If you don’t understand the scripts and feed them unstructured information, they will either fail or mangle your source files. <strong>Be warned!</strong></p>
<h2 id="folders">Folders</h2>
<p>Unless you make changes to the scripts (which you are by all means invited to do if you know what you are doing), they depend on a given directory structure, created in the directory where you will keep your “build root”:</p>
<ul>
<li><code>templates</code> : the HTML template and a few other snippets;</li>
<li><code>src/pages</code> : for fixed pages, like “About”, “History” etc;</li>
<li><code>src/posts</code> : for the dynamic content;</li>
<li><code>images</code> : full-size pictures;</li>
<li><code>posts</code> : empty directory to receive the posts HTML;</li>
<li><code>pages</code> : empty directory to receive the pages HTML;</li>
<li><code>tags</code> : empty directory to receive the tags dirs;</li>
<li><code>categories</code> : empty directory to receive the category dirs;</li>
<li><code>archives</code> : empty directory to host the archives;</li>
<li><code>scripts</code>: where you’ll put the shell scripts.</li>
</ul>
<p>Though I have not yet fully implemented the concept, some of these directories support name customisation by changing lines in the <code>site_vars.sh</code> file.</p>
<h2 id="templates">Templates</h2>
<p>The HTML template (filename <code>blog.html</code>) is generated by the <code>update_template.sh</code> script, from the following files:</p>
<ol type="1">
<li><code>head1.tpl</code></li>
<li><code>head2.tpl</code></li>
<li><code>head3.tpl</code></li>
<li><code>head4.tpl</code></li>
<li><code>head5.tpl</code></li>
<li><code>head6.tpl</code></li>
<li><code>body.tpl</code></li>
<li><code>foot.tpl</code></li>
</ol>
<p>These files are not meant to be edited, unless you know well what you are doing and why. Their different functions are explained further down.</p>
<p>The actual templates you want to customise are called <code>sbar.txt</code> and <code>footer.txt</code>. Other than that, you don’t need to change any templates, just edit the variables file (<code>site_vars.sh</code>) in the <code>scripts</code> directory and that will be used to fill in the placeholders.</p>
<p><code>sbar.txt</code> : is your navigation section, where you will write your navigation links and any other content you want to put in your sidebar or menu.</p>
<p><code>footer.txt</code> : contains your copyright claim (if any) as well as any messages you want to appear below every page.</p>
<p>A file named <code>sidebar.txt</code> is created in the same directory by the output of the scripts — it’s safe to delete it whenever you want, but it will always come back, so don’t bother.</p>
<h2 id="source-tree">Source tree</h2>
<p>The blog source tree (<code>src/</code>) keeps the landing page info (<code>src/index.md</code>), blog posts (<code>src/posts/</code>) and fixed pages (<code>src/pages/</code>). Throughout the source tree, Markdown files (suffix <code>.md</code>) are the content you write and plain text files (suffix <code>.txt</code>) are produced by scripts processing your content, throughout the many phases of compilation, and HTML files (suffix <code>.html</code>) are the output content produced by Pandoc.</p>
<p>All site content must be writting in Markdown. You can use any Markdown features supported by Pandoc (do read their documentation and add the required extension code to <code>src/site_vars.sh</code>). The default Pandoc invocation I use is <code>markdown+smart+yaml_metadata_block+implicit_figures</code>, which means “Pandoc’s own markdown dialect, extended with smart punctuation, yaml metadata blocks and putting images in a ‘figure’ environment by default”. I find this setup pretty basic, but powerful enough to provide good quality. Unless you need something specific, like MathML, LaTeX output etc., there is no need to change it.</p>
<h3 id="the-landing-page">The landing page</h3>
<p>The default landing page contains three blocks of content:</p>
<dl>
<dt>Site greeting</dt>
<dd>read from the <code>index.md</code> which you write in the source tree.
</dd>
<dt>Pinned content</dt>
<dd>which is compiled from a post or page you have symlink to <code>pinned.md</code> in the build root.
</dd>
<dt>Recent posts</dt>
<dd>compiled from a file called <code>recent.txt</code> created in the build root previously to compilation.
</dd>
</dl>
<p>Any content you write to the <code>index.md</code> file will appear at the top of the landing page in a larger font.</p>
<p>If you delete (or never create) a <code>pinned.md</code> file, the landing page will not have a pinned content area.</p>
<p>Anything else you want to change (or if you want to add content after the recent posts), you must change the script that compiles the homepage.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<h3 id="fixed-pages">Fixed pages</h3>
<p>Fixed pages have plain names, preferably short and easy to memorise — like <code>bio.md</code>, <code>about.md</code>, <code>blogroll.md</code>, etc. These names will result in URLs like <code>http://baseurl/pages/bio.html</code>, which are meant to be easy to be remember. Whatever really important information should have such URLs, but they must be used sparingly, as pages don’t organise content.</p>
<h3 id="blog-posts">Blog posts</h3>
<p>Blog posts must be written in Markdown and named according to <code>YYYY-MM-DD-post-title.md</code>; in which <code>YYYY</code> is the year written as four digits (e.g. “2021”), <code>MM</code> is the month in two digits (e.g. from “01” to “12”) and <code>DD</code> is the day in two digits (from “01” to “31”). The date must be written with hyphens to keep the URL working. Words in the filename can be separated by either hyphens or underscores (as you wish, but <em>not</em> by spaces or special characters other than these). The <code>YYYY-MM-DD</code> block must be separated from the title by a hyphen.</p>
<p>These are valid blog post file names:</p>
<pre><code>2021-11-16-a-trip-to-london.md
2021-11-16-A-Trip-To-London.md
2021-11-16-A_Trip_to_London.md
2021-11-16-a_trip_to_london.md
2021-11-16-a_trip-to_london.md</code></pre>
<p>But these aren’t (if you’re even able to create files named as such in your system, which you may not be, I’m afraid):</p>
<pre><code>2021_11_16_a_trip_to_london.md 
2021-11-16-a trip to london.md
2021-11-16-a%trip%to%london.md
2021/11/16-a*trip*to*london.md
2021-16-11-a-trip-to-london.md</code></pre>
<p>The last one will not spit an error, but will result in gibberish because there is no 16^th month.</p>
<h3 id="metadata">Metadata</h3>
<p>Post metadata shall be written in <code>yaml</code> format and included in the <em>beginning</em> of the file. In theory, a metadata block can be included anywhere in the post, but for the sake of clarity and organisation it’s already better to put it there. For the purpose of this script, putting a <code>yaml</code> block elsewhere <em>may</em> not harm the output, but will be ignored at best.</p>
<p>The scripts need at least “title” and “date” to generate the blog without issues. If you won’t use categories and tags, you may not include them in the sources, but there’s really no point in refusing to use them, as they are so darn useful.</p>
<p>You can include a “toc” metadata (either “true” or “false”), in really long pages or posts, with many sub-headings. I have prepared the scripts to recognise the “toc” metadata and proceed accordingly.</p>
<p>You can also include a “coverImage” metadata, pointing to an image file. The script will use this image file as the thumbnail shown in some post lists.</p>
<p>Any other metadata declarations will <em>probably</em> be ignored, but aren’t safe to include, unless you know well how Pandoc handles them. I don’t claim to be an expert in that particular matter.</p>
<h3 id="text-formatting">Text formatting</h3>
<p>All content is just <a href="http:markdownguide.org">Markdown</a>, which you probably know what is at this point. If you don’t, do take some time to read some documentation about the format. If you don’t need much in terms of formatting, you’ll probably do well with the most basic knowledge, that is:</p>
<ul>
<li>Write plain text in a text editor, not in Word or whatever that is even remotely similar to Word;</li>
<li>Blocks of text separated by empty lines make paragraphs;</li>
<li>Emphasise passages using asterisks (one for italics, two for boldened text);</li>
<li>Subheadings are made using hashes (up from two to six, as you go deeper in subheading nesting), but don’t use one hash only (as in <code># Heading 1</code>) because the first-level heading is reserved for the post title, which is given by the <code>yaml</code> metadata block.</li>
</ul>
<p>If you need more than this, then you <strong>do</strong> need to read the full documentation.</p>
<h3 id="images">Images</h3>
<p>To keep the build tree tidy you should create an <code>images</code> folder in the root directory and put all images there. There’s no specification for image format, of course, but my experience is that JPGs are better for detailed images that will appear at a bigger size and PNG files are better for everything else.</p>
<p>The reason why I prefer JPGs for big images isn’t quality, but bandwidth saving as they have better (lossy) compression for photographs. Ideally, you should resize all images down to 100% of the minimum width of your text area. That way you don’t use too much transfer bandwidth with images that are bigger than absolutely necessary.</p>
<h1 id="templates-1">Templates</h1>
<p>Pandoc will build the site from a set of templates, which you can customise, of course. Three of them are required and a fourth you can add if you wish.</p>
<h2 id="the-html5-template">The HTML5 template</h2>
<p>The default Pandoc HTML5 template is pretty basic and nothing much needs to be changed in it, unless you know very well what you are doing.</p>
<p>The beginning part is especially unchangeable:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>include{templates/head1.tpl}</span></code></pre></div>
<p>Now comes styling. I have used open-source fonts from the <a href="https://fontlibrary.org">Open Font Library</a> and the scripts expect them, but you can pick any fonts you want, you just need to adjust the template and the stylesheets. If you plan to use fonts from OFL as I did, put their names in the <code>site_vars.sh</code> file as the “text” and “head” variables and then follow the guidelines for font-face choosing, which are found in the CSS files themselves.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Font Stylesheets --&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;screen&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;https://fontlibrary.org/face/$textfont$&quot;</span> <span class="er">type</span><span class="ot">=</span><span class="st">&quot;text/css&quot;</span><span class="kw">/&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>$if(headfont)$</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;screen&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;https://fontlibrary.org/face/$headfont$&quot;</span> <span class="er">type</span><span class="ot">=</span><span class="st">&quot;text/css&quot;</span><span class="kw">/&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>$endif$</span></code></pre></div>
<p>Local style sheets will hold your actual styles. I have preset four style files, loaded in this specific order, so that they “cascade” as expected, resulting in a consistent and responsive layout.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Local Stylesheets --&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;screen&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/common.css&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;only screen and (max-width: 599px)&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/mobile.css&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;only screen and (min-width: 600px)&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/desktp.css&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;screen&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/content.css&quot;</span> <span class="kw">/&gt;</span></span></code></pre></div>
<p>The two last things are the link to the Atom Feed (a pretty basic one) and to the Font Awesome kit providing the basic icons. <em>I use them</em>, the setup is free and there’s no real reason not to use Font Awesome, unless you absolutely don’t know what to do with it. At this moment, I only use five of their icons, to build the Creative Commons licensing at the footer and to create a warning icon I use in some places, but I will use Font Awesome more often in actual <em>post content</em>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;atom.xml&quot;</span> <span class="er">type</span><span class="ot">=</span><span class="st">&quot;application/atom+xml&quot;</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;alternate&quot;</span> <span class="er">title</span><span class="ot">=</span><span class="st">&quot;Sitewide Atom feed&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We&#39;re using FontAwesome, though we don&#39;t know much about what we can do with it --&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;https://kit.fontawesome.com/a64519a0e0.js&quot;</span> <span class="er">crossorigin</span><span class="ot">=</span><span class="st">&quot;anonymous&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span></code></pre></div>
<p>Before the actual page content there are two more bits to add, the site header and the sidebar/menu.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;masthead&quot;</span><span class="kw">&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;site-name&quot;</span><span class="kw">&gt;&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/&quot;</span> <span class="er">title</span><span class="ot">=</span><span class="st">&quot;$site_id$&quot;</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;home&quot;</span><span class="kw">&gt;</span>$site_id$<span class="kw">&lt;/a&gt;&lt;/div&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;site-description&quot;</span> <span class="er">title</span><span class="ot">=</span><span class="st">&quot;$site_desc$&quot;</span><span class="kw">&gt;</span>$site_desc$<span class="kw">&lt;/div&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;site-data&quot;</span><span class="kw">&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;span</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;byline&quot;</span> <span class="er">title</span><span class="ot">=</span><span class="st">&quot;$author$&quot;</span><span class="kw">&gt;</span>by $signature$<span class="kw">&lt;/span&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;span</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;update&quot;</span><span class="kw">&gt;</span>$updmsg$<span class="kw">&lt;span</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;date&quot;</span><span class="kw">&gt;</span>$update$<span class="kw">&lt;/span&gt;&lt;/span&gt;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;span</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;tag&quot;</span><span class="kw">&gt;</span>DESDE 2010<span class="kw">&lt;/span&gt;&lt;/div&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;sidebar&quot;</span><span class="kw">&gt;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>      $sidebar$</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<p>The sidebar is actually a misnomer, as this is where navigation goes. It can be either a sidebar, if you are a conservative, like me, be styled in the most outlandish way you wish. Know your CSS and make it your way.</p>
<p>The main content area in the template is the same for both posts and pages: there are conditions put in place that will format the output depending on the presence or absence of certain variables. By default the publish date, the tags and categories variables are not evoked by the page compilation script, only by the article compilation; so, it doesn’t matter if you add tags and publish dates to a page, they won’t appear anywhere.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;main&quot;</span><span class="kw">&gt;&lt;h1</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;header&quot;</span><span class="kw">&gt;</span>$title$<span class="kw">&lt;/h1&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;main-content&quot;</span><span class="kw">&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>        $if(published)$</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>          <span class="kw">&lt;div</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;published&quot;</span><span class="kw">&gt;</span>Publicado em: $published$<span class="kw">&lt;/div&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        $endif$</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        $if(toc)$</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;$idprefix$TOC&quot;</span> <span class="er">role</span><span class="ot">=</span><span class="st">&quot;doc-toc&quot;</span><span class="kw">&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        $if(toc-title)$</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;b</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;$idprefix$toc-title&quot;</span><span class="kw">&gt;</span>$toc-title$<span class="kw">&lt;/b&gt;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        $endif$</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        $table-of-contents$</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;/div&gt;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        $endif$</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>              $body$</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        $if(published)$</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;categories&quot;</span><span class="kw">&gt;&lt;b&gt;</span>Arquivado em: <span class="kw">&lt;/b&gt;</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>              $for(categories)$</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>              <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/categorias/$categories$/index.html&quot;</span><span class="kw">&gt;</span>$categories$<span class="kw">&lt;/a&gt;</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>              $endfor$</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;/div&gt;</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;tags&quot;</span><span class="kw">&gt;&lt;b&gt;</span>Assuntos: <span class="kw">&lt;/b&gt;</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>              $for(tags)$</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>              <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/assuntos/$tags$/index.html&quot;</span><span class="kw">&gt;</span>$tags$<span class="kw">&lt;/a&gt;</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>              $endfor$</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;/div&gt;</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>        $endif$</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/div&gt;</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<p>And finally comes the footer area, which will just print the contents of your footer file.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;footer&quot;</span><span class="kw">&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>          $for(include-after)$</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>          $include-after$</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>          $endfor$</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>          $footer$</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<p>Future versions of this may remove the sidebar and footer variables from Pandoc’s evocation, as these can be more easily inserted directly into the template file. The reason why I have not yet done that is that having separate template bits and template inputs can preserve a way to insert content via command line, which <em>may</em> be useful, though I am not yet sure when or how.</p>
<h3 id="the-sbar.txt-input-file">The <code>sbar.txt</code> input file</h3>
<p>You can structure your navigation any way you want, but I advise you to base it on the following elements, to make CSS styling a bit easier:</p>
<ul>
<li><p><code>&lt;div role="navigation" class="navigation"&gt;</code> : where you will put your main links in an <code>&lt;ul class="menu"&gt;</code></p></li>
<li><p><code>&lt;div class="bloglinks"&gt;</code> : for links of lesser importance, also in an <code>&lt;ul class="links"&gt;</code></p></li>
<li><p><code>&lt;div class="widget"&gt;</code> : for any other element which is not a link.</p></li>
</ul>
<h3 id="the-footer.txt-input-file">The <code>footer.txt</code> input file</h3>
<p>You can put anything in your footer, but I advise you to include, at least, your copyright information (<code>&lt;div id="license"&gt;</code>) separated from random site info (<code>&lt;p id="site-info"&gt;</code>). My own site has the following information in the footer:</p>
<ul>
<li>CC-BY-ND-SA (icons) Creative Commons Attribution Non-Derivative Share-Alike license tag (with the respective link).</li>
<li>An appeal for correct content attribution.</li>
<li>An explanation about the use of Markdown and Pandoc to compile the site and an attribution to Jilles van Gurp for inspiration.</li>
<li>Mention of the Open Font Library, where the fonts are hosted.</li>
<li>Links to the code repository.</li>
</ul>
<h1 id="processing-the-blog">Processing the blog</h1>
<p>Blog processing is done in stages:</p>
<ol type="1">
<li>Content creation (don’t even start if you have nothing to post…);</li>
<li>Folder setup (<code>mkdir</code> the places you will use, <code>chmod</code> the directories, <code>symlink</code> them, if need, edit the webserver config if you plan to develop live etc.);</li>
<li>Variables setup (edit the <code>site_vars.sh</code> script);</li>
<li>Preprocessing</li>
<li>Compilation</li>
<li>Upload</li>
</ol>
<p>This document is about steps 3 to 5. The first one you must do on your own (I can’t provide any advice on that), the second has been explained <a href="#folders">above</a> and the last one each user will choose to do differently.</p>
<h2 id="setting-up-site-variables">Setting up site variables</h2>
<p>The file <code>site_vars.sh</code> stores a series of variables that will be read by every other script from now on. It is an absolute requirement that you edit it before you do anything else. I have provided a blank one, that you need to fill in. <em>Every variable is required</em>, though they some can have blank values.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="va">site_id</span><span class="op">=</span><span class="st">&quot;Letras Elétricas&quot;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="va">site_desc</span><span class="op">=</span><span class="st">&quot;Textões e ficções sem compromisso&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="va">baseurl</span><span class="op">=</span><span class="st">&quot;http://letraseletricas.blog.br&quot;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="va">author</span><span class="op">=</span><span class="st">&quot;José Geraldo Gouvêa&quot;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="va">signature</span><span class="op">=</span><span class="st">&quot;J. G. Gouvêa&quot;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="va">updmsg</span><span class="op">=</span><span class="st">&quot;Atualizado em: &quot;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace catprefix and tagprefix with your localized names.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="va">catprefix</span><span class="op">=</span><span class="st">&quot;categorias&quot;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="va">tagprefix</span><span class="op">=</span><span class="st">&quot;assuntos&quot;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="va">archive</span><span class="op">=</span><span class="st">&quot;arquivo&quot;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Unvariable variables... Don&#39;t mess with this part of the script.</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># These are some failsafes.</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="va">first_year</span><span class="op">=</span>2007</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="va">current_year</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="st">&#39;+%Y&#39;</span><span class="va">)</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="va">TIME</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">date</span> <span class="st">&#39;+%s&#39;</span><span class="va">)</span><span class="st">&quot;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># We&#39;ll extract some information that will be used in the templates:</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># a) how big is my blog directory? how many posts in there?</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="va">postcount</span><span class="op">=</span><span class="va">$(</span><span class="fu">ls</span> src/posts/<span class="pp">*</span>-<span class="pp">*</span>.md <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span><span class="va">)</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co"># b) how many tags do we have?</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="va">tagcount</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> taglist.txt <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span><span class="va">)</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># c) how many categories?</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="va">catcount</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> catlist.txt <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span><span class="va">)</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co"># d) when did I post for the last time?</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="va">last_post</span><span class="op">=</span><span class="va">$(</span><span class="fu">stat</span> <span class="at">-c</span> <span class="st">&quot;%w&quot;</span> <span class="va">$(</span><span class="fu">find</span> src/posts/<span class="va">$current_year</span>-<span class="pp">*</span>.md <span class="at">-type</span> f<span class="va">)</span> <span class="kw">|</span> <span class="fu">tail</span> <span class="at">-n</span> 1 <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39; &#39;</span> <span class="at">-f1</span><span class="va">)</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="va">last_time</span><span class="op">=</span><span class="va">$(</span><span class="fu">stat</span> <span class="at">-c</span> <span class="st">&quot;%w&quot;</span> <span class="va">$(</span><span class="fu">find</span> src/posts/<span class="va">$current_year</span>-<span class="pp">*</span>.md <span class="at">-type</span> f<span class="va">)</span> <span class="kw">|</span> <span class="fu">tail</span> <span class="at">-n</span> 1 <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39; &#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="va">update</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$last_post</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co"># The templates</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co"># We begin with a raw sidebar, where we have marked the places for the </span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co"># information variables above. We copy it to another file (which Pandoc</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co"># will actually use) and perform sed replacements in the copied file,</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co"># preserving the original for a future run.</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> templates/sbar.txt templates/sidebar.txt</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&quot;s/POSTCOUNT/</span><span class="va">$postcount</span><span class="st">/g&quot;</span> templates/sidebar.txt</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&quot;s/TAGCOUNT/</span><span class="va">$tagcount</span><span class="st">/g&quot;</span> templates/sidebar.txt</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&quot;s/CATCOUNT/</span><span class="va">$catcount</span><span class="st">/g&quot;</span> templates/sidebar.txt</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="va">pageside</span><span class="op">=</span><span class="st">&quot;templates/sidebar.txt&quot;</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="va">pagefoot</span><span class="op">=</span><span class="st">&quot;templates/footer.txt&quot;</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonts for text and headlines</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="va">textfont</span><span class="op">=</span><span class="st">&quot;cmu-concrete&quot;</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="va">headfont</span><span class="op">=</span><span class="st">&quot;cmu-bright&quot;</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co"># But exactly how will I evoke pandoc</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="va">panopts</span><span class="op">=</span><span class="st">&quot;markdown+smart+yaml_metadata_block+implicit_figures&quot;</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that the html template is always up to date with any</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co"># changes made to its constituent parts.</span></span></code></pre></div>
<p>Having set up your varibles, time to move on to actually building your blog, which you <em>should</em> do in the following order:</p>
<h2 id="preprocessing">Preprocessing</h2>
<p>Preprocessing consists of <em>optional</em> steps that gather information to be later used in building the site. Most preprocessing can be done once and never again, if you are careful. Anyway, if you need to run them, do make a full build to update everything.</p>
<h3 id="listing-the-categories">Listing the categories</h3>
<p>As you’ve been told, <em>categories</em> refer to the textual genre of the post. Therefore, you won’t have too many. My own blog does only have the following: “short stories”, “reviews”, “articles”, “flash fiction”, “essays”, “incomplete”, “fragments”, “novellas”, “novels”, “updates”, “opinion”, “musings”, “translations”, “tutorials”, “poetry” and “criticism”.</p>
<p>This script reads all blog posts in <code>src/posts/</code> and feeds them into Pandoc, which then pipes them to <code>jq</code>, which lists the categories into a file called <code>catlist.txt</code> in the build root. This file is renewed every time the script is run.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> catlist.txt</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> post <span class="kw">in</span> <span class="kw">`</span><span class="fu">find</span> src/posts <span class="at">-type</span> f <span class="at">-iname</span> <span class="dt">\*</span>.md<span class="kw">`</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--template</span><span class="op">=</span>templates/metadata.tpl <span class="va">$post</span> <span class="dt">\</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> <span class="st">&#39;.categories|tsv&#39;</span> <span class="op">&gt;&gt;</span> taglist.txt</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tr</span> <span class="st">&#39;\t&#39;</span> <span class="st">&quot;\n&quot;</span> <span class="op">&lt;</span> catlist.txt <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="op">&gt;</span> _catlist</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> _catlist catlist.txt</span></code></pre></div>
<p>In theory, you only need to run this script exactly <em>once</em>, when you setup the blog, and even then, only if you have a large number of posts imported from a WordPress installation. If you are manually adding posts to your blog, <em>after</em> you have compiled it, or if you are writing your blog from scratch, it’s probably better to just curate yourself a list of categories named <code>catlist.txt</code> in the build root folder. Just put each category in a line of its own, using underscores to link words, thus avoiding spaces in filenames. And remember not to delete it by accident.</p>
<h3 id="listing-the-tags">Listing the tags</h3>
<p>As you’ve been told, <em>tags</em> refer to the subject matter of the post. Therefore, you can have as many as you need or wish. My blog used to have about 300 of them, thanks to the <em>useful</em> contribution of my readers, who couldn’t resist tagging my posts when I enabled the “comments can add tags” WordPress plugin. However, having too many tags defeats the purpose of having tags anyway <em>and will slow your blog</em>.</p>
<p>The script is identical to <code>get_cats.sh</code> (but for replacing tags for categories where needed). It reads all posts in <code>src/posts/</code> and feeds them into Pandoc, which then pipes them to <code>jq</code>, which lists the tags into a file called <code>taglist.txt</code> in the build root. This file is renewed every time the script is run.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> taglist.txt</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> post <span class="kw">in</span> <span class="kw">`</span><span class="fu">find</span> src/posts <span class="at">-type</span> f <span class="at">-iname</span> <span class="dt">\*</span>.md<span class="kw">`</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--template</span><span class="op">=</span>templates/metadata.tpl  <span class="va">$post</span> <span class="dt">\</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> <span class="st">&#39;.tags|tsv&#39;</span> <span class="op">&gt;&gt;</span> taglist.txt</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tr</span> <span class="st">&#39;\t&#39;</span> <span class="st">&quot;\n&quot;</span> <span class="op">&lt;</span> taglist.txt <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="op">&gt;</span> _taglist</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> _taglist taglist.txt</span></code></pre></div>
<p>In theory, you only need to run this script exactly <em>once</em>, when you setup the blog, if you have a large number of posts imported from a WordPress installation. If you are adding posts to your blog, <em>after</em> you have compiled it, or if you are writing your blog from scratch, it’s probably better to just curate yourself a list of tags named <code>taglist.txt</code> in the build root folder. Just put each tag in a line of its own, using underscores to link words, thus avoiding spaces in filenames.</p>
<h3 id="finding-the-recent-posts">Finding the recent posts</h3>
<p>Every time you add a new entry to your blog you must make it appear in the landing page, so your visitors know about it. This script does just that, it lists the six most recent files you created there, greps them for content and formats the information in HTML, redirecting that into a file named <code>recent.txt</code> in the build root.</p>
<p>At this point the scripts will identify the most recent post in your source tree and store its date in a variable which will be added to your “sidebar”, advertising to the world when you last posted something.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> recent.txt </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> rec <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> src/posts <span class="at">-type</span> f <span class="at">-iname</span> <span class="dt">\*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-ur</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 6<span class="va">)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="va">entry</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$rec</span> .md<span class="va">)</span><span class="st">.html&quot;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;title: &quot;</span> <span class="va">$rec</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="va">plink</span><span class="op">=</span><span class="st">&quot;posts/</span><span class="va">$entry</span><span class="st">&quot;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="va">teaser</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$rec</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;1,/^$/d&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;/^$/,$d&#39;</span> <span class="kw">|</span> <span class="ex">pandoc</span> <span class="va">)</span> </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="va">cover</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;coverImage:&quot;</span> <span class="va">$rec</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="va">date</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;date: &quot;</span> <span class="va">$rec</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39; &#39;</span> <span class="at">-f2</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$date</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$cover</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="cf">then</span> </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="va">coverpic</span><span class="op">=</span><span class="st">&#39;&lt;figure class=&quot;thumb&quot;&gt;&lt;img src=&quot;/images/$cover&quot; /&gt;&lt;/figure&gt;&#39;</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="va">coverpic</span><span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;div class=</span><span class="dt">\&quot;</span><span class="st">recent-posts</span><span class="dt">\&quot;</span><span class="st">&gt;</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="st">## [</span><span class="va">$title</span><span class="st">](</span><span class="va">$plink</span><span class="st">)</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="va">$coverpic</span><span class="st"> </span><span class="va">$teaser</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/div&gt;</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> recent.txt</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<p>This is <em>all</em> that this script does. It doesn’t really compile anything, it just prepares a list of recent posts that will be later used to compile the landing page.</p>
<h3 id="setting-up-the-pinned-post">Setting up the pinned post</h3>
<p>Pinned content is what you want to have in your landing page, regardless of its recency. Content you don’t want to replace with your newer content. You could write this content into the <code>index.md</code> file, but that could be too cumbersome if your pinned content is long and complex. Here comes the <code>set_pinned.sh</code> script to rescue:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="va">pintitle</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;title: &quot;</span> pinned.md <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="va">pinlink</span><span class="op">=</span><span class="va">$(</span><span class="fu">readlink</span> pinned.md <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/.md/.html/g&#39;</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f2,3</span><span class="va">)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="va">pintease</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> pinned.md <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;1,/^$/d&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;/^$/,$d&#39;</span><span class="va">)</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;div id=</span><span class="dt">\&quot;</span><span class="st">pinned</span><span class="dt">\&quot;</span><span class="st">&gt;</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="st">## [</span><span class="va">$pintitle</span><span class="st">](</span><span class="va">$pinlink</span><span class="st">)</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;div class=</span><span class="dt">\&quot;</span><span class="st">info-icon</span><span class="dt">\&quot;</span><span class="st">&gt;&lt;i class=</span><span class="dt">\&quot;</span><span class="st">fas fa-info-circle</span><span class="dt">\&quot;</span><span class="st">&gt;&lt;/i&gt;&lt;/div&gt;</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="va">$pintease</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/div&gt;</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> pinned.txt</span></code></pre></div>
<p>This script does for the pinned post, which you have manually symlinked to <code>pinned.md</code>, the same that <code>set_recent.sh</code> does for recent posts, but it doesn’t need a cover image, as it uses a FontAwesome-provided warning icon.</p>
<p>You will notice that it outputs to <code>pinned.txt</code>. There are two files named “pinned” in the build root, one is a symlink to a Markdown file you have written, the other is a text file created by this script. If you link your pinned content to <code>pinned.txt</code> instead of <code>pinned.md</code> something nasty will happen: you will destroy the contents of the file containing your pinned post. <strong>So, don’t do that!</strong></p>
<h2 id="compilation">Compilation</h2>
<p>Because all scripts process the Markdown source files in the source tree and write to the output folders in the build root directory, they don’t depend on the HTML output for anything. The “do” scripts can also be used in any order as well.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<h3 id="building-the-landing-page">Building the landing page</h3>
<p>Once you have written your greetings, set a pinned post and have written at least six posts, you can compile your landing page:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>       <span class="dt">\</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   sidebar=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pageside)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    footer=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pagefoot)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> lang=<span class="st">&quot;pt&quot;</span> <span class="dt">\</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span> index.html <span class="at">--standalone</span> src/index.md pinned.txt recent.txt </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Homepage compiled ...&quot;</span></span></code></pre></div>
<p>This is the first time Pandoc is actually evoked to process Markdown files. Everything here is fed up from the <code>site_vars.sh</code> file (which you have surely edited to your liking) and based on the HTML5 template (here called <code>blog.htm</code>, but you can name it anything you want), the sidebar and the footer. Just change the language tag from (“pt”) if you don’t write in Portuguese. There’s nothing else special here.</p>
<p>This is also the same basic Pandoc evocation that will be used again and again in the next steps, only changing the inputs and outputs.</p>
<p>You can see, in the end, that Pandoc concatenates the three input files (<code>index.md</code>, <code>pinned.txt</code> and <code>recent.txt</code>) before processing them, and writes the output to <code>index.html</code> in the build root.</p>
<h3 id="category-pages-and-category-index">Category pages and category index</h3>
<p>This script reads all blog posts in <code>src/posts/</code> and greps them for the categories listed in the <code>catlist.txt</code> file in the build root. The filenames are written to a list that will be input in a later stage. In the end, the script builds a page for every category listing posts belonging to it, and then an index page listing all categories.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="va">$catprefix</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="va">catprefix</span><span class="op">=</span><span class="st">&quot;categories&quot;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="va">$tagprefix</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="va">tagprefix</span><span class="op">=</span><span class="st">&quot;tags&quot;</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Will create and populate category pages.&quot;</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> category <span class="kw">in</span> <span class="kw">`</span><span class="fu">cat</span> catlist.txt<span class="kw">`</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="va">ind</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">/</span><span class="va">$category</span><span class="st">/index.txt&quot;</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="va">tmp</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">/</span><span class="va">$category</span><span class="st">/_posts.txt&quot;</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$catprefix</span>/<span class="va">$category</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$catprefix</span>/<span class="va">$category</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="st">title: Artigos da categoria </span><span class="dt">\&quot;</span><span class="va">$category</span><span class="dt">\&quot;</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;div class=</span><span class="dt">\&quot;</span><span class="st">postlist</span><span class="dt">\&quot;</span><span class="st">&gt;</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> <span class="va">$ind</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Grepping each post by category.&quot;</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-le</span> <span class="st">&quot;  - </span><span class="dt">\&quot;</span><span class="va">$category</span><span class="dt">\&quot;</span><span class="st">&quot;</span> src/posts/<span class="pp">*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span> <span class="op">&gt;</span> <span class="va">$tmp</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Listing posts in categories.&quot;</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> blogpost <span class="kw">in</span> <span class="kw">`</span><span class="fu">cat</span> <span class="va">$tmp</span><span class="kw">`</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    <span class="va">fdate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f1,2,3</span><span class="va">)</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="va">plink</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span>.html<span class="va">)</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-e</span> <span class="st">&quot;title: </span><span class="dt">\&quot;</span><span class="st">&quot;</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="va">pyear</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%Y&#39;</span><span class="va">)</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;- &lt;span class=</span><span class="dt">\&quot;</span><span class="st">pdate</span><span class="dt">\&quot;</span><span class="st">&gt;</span><span class="va">$pdate</span><span class="st">&lt;/span&gt; - [</span><span class="va">$title</span><span class="st">](/posts/</span><span class="va">$plink</span><span class="st">)&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$ind</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Encontrado </span><span class="dt">\&quot;</span><span class="va">$title</span><span class="dt">\&quot;</span><span class="st">, de </span><span class="va">$pdate</span><span class="st">, categoria </span><span class="dt">\&quot;</span><span class="va">$category</span><span class="dt">\&quot;</span><span class="st">.&quot;</span>  </span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;/div&gt;&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$ind</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Compiling category index pages&quot;</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>  <span class="va">$ind</span>   <span class="dt">\</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>     <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span> <span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">/</span><span class="va">$category</span><span class="st">/</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$ind</span> .txt<span class="va">)</span><span class="st">.html&quot;</span> <span class="dt">\</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   sidebar=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pageside)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    footer=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pagefoot)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   baseurl=<span class="st">&quot;..&quot;</span> <span class="at">-V</span> lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a><span class="st">title: </span><span class="dt">\&quot;</span><span class="st">Lista de categorias</span><span class="dt">\&quot;</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a><span class="st">Categorias procuram classificar o conteúdo quanto ao gênero</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a><span class="st">textual e à intenção da escrita. As categorias do </span><span class="dt">\&quot;</span><span class="st">Letras Elétricas</span><span class="dt">\&quot;</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a><span class="st">são herdadas do antigo blog em WordPress e serão gradualmente </span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a><span class="st">alteradas, à medida que os posts forem editados.</span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a><span class="st">|:---:|:---:|:---:|&quot;</span> <span class="op">&gt;</span> <span class="va">$catprefix</span>/index.txt</span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> catlist.txt <span class="va">$catprefix</span>/_catlist.txt </span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="at">-d</span><span class="st">&#39; &#39;</span> catlist.txt <span class="va">$catprefix</span>/_catlist.txt <span class="op">&gt;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span>  <span class="st">&#39;s/ $//g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a><span class="fu">tr</span> <span class="at">-s</span> <span class="st">&quot; &quot;</span> <span class="op">&lt;</span> <span class="va">$catprefix</span>/_index.txt <span class="op">&gt;</span> <span class="va">$catprefix</span>/__index.txt</span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$catprefix</span>/__index.txt <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/$/ |/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="va">$catprefix</span>/_index.txt <span class="kw">|</span> <span class="fu">tr</span> <span class="dt">\ </span> <span class="dt">\\</span>n <span class="kw">|</span> <span class="ex">column</span> <span class="at">-x</span> <span class="at">-c</span> 150 <span class="op">&gt;</span> <span class="va">$catprefix</span>/__index.txt</span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$catprefix</span>/__index.txt <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/\t/ /g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/  / /g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/^/| /g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/ |/\/index.html) |/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/| /| [/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/ /] /g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/|]/|/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/] /](/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/](|/ |/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="va">$catprefix</span>/_index.txt <span class="op">&gt;&gt;</span> <span class="va">$catprefix</span>/index.txt</span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span></span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a><span class="st">|:----:|----:|</span></span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a><span class="st">| [Retornar aos posts](/posts/index.html) | [Retornar à home](/index.html) |</span></span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;&gt;</span> <span class="va">$catprefix</span>/index.txt</span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>  <span class="va">$catprefix</span>/index.txt   <span class="dt">\</span></span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true" tabindex="-1"></a>     <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span> <span class="va">$catprefix</span>/index.html <span class="dt">\</span></span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   sidebar=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pageside)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    footer=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pagefoot)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-118"><a href="#cb16-118" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-119"><a href="#cb16-119" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   baseurl=<span class="st">&quot;..&quot;</span> <span class="at">-V</span> lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb16-120"><a href="#cb16-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-121"><a href="#cb16-121" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-z</span> <span class="st">&#39;s/&lt;table&gt;/&lt;table class=\&quot;back\&quot;&gt;/2&#39;</span> <span class="va">$catprefix</span>/index.html <span class="op">&gt;</span> posts.htm</span>
<span id="cb16-122"><a href="#cb16-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-123"><a href="#cb16-123" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> posts.htm <span class="va">$catprefix</span>/index.html</span>
<span id="cb16-124"><a href="#cb16-124" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb16-125"><a href="#cb16-125" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Categories index prepared&quot;</span></span></code></pre></div>
<p>As you can see, we generate one <code>index.html</code> page for every category, and then an <code>index.html</code> for the categories folder itself, containing a table with all categories in it.</p>
<h3 id="compiling-tag-pages-and-tag-index">Compiling tag pages and tag index</h3>
<p>The <code>do_tags.sh</code> script does more or less the same as the <code>do_cats.sh</code> script, except that it works with the “tags” taxonomy. A few bits here and there are tweaked, but the script is basically the same. Besides changing <code>$catprefix</code> for <code>$tagprefix</code> in every line, you must adjust the column width from <code>column -x -c 150</code> to <code>column -x -c 230</code> because tags tend to have longer names than categories and the table will not work then (you don’t need to do that, though, if the script works for you).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Will build index pages for the tags&quot;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tag <span class="kw">in</span> <span class="kw">`</span><span class="fu">cat</span> taglist.txt<span class="kw">`</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="va">ind</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">/</span><span class="va">$tag</span><span class="st">/index.txt&quot;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="va">tmp</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">/</span><span class="va">$tag</span><span class="st">/_posts.txt&quot;</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$tagprefix</span>/<span class="va">$tag</span>/<span class="pp">*</span>.txt</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$tagprefix</span>/<span class="va">$tag</span>/</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="st">title: Postagens sobre </span><span class="dt">\&quot;</span><span class="va">$tag</span><span class="dt">\&quot;</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;div class=</span><span class="dt">\&quot;</span><span class="st">postlist</span><span class="dt">\&quot;</span><span class="st">&gt;</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> <span class="va">$ind</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Grepping posts for tags,</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="st">This may take a long time.&quot;</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-le</span> <span class="st">&quot;  - </span><span class="dt">\&quot;</span><span class="va">$tag</span><span class="dt">\&quot;</span><span class="st">&quot;</span> src/posts/<span class="pp">*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span> <span class="op">&gt;</span> <span class="va">$tmp</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Populating tag index pages.&quot;</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> blogpost <span class="kw">in</span> <span class="kw">`</span><span class="fu">cat</span> <span class="va">$tmp</span><span class="kw">`</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    <span class="va">fdate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f1,2,3</span><span class="va">)</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    <span class="va">plink</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span>.html<span class="va">)</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-e</span> <span class="st">&quot;title: </span><span class="dt">\&quot;</span><span class="st">&quot;</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    <span class="va">pyear</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%Y&#39;</span><span class="va">)</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;- &lt;span class=</span><span class="dt">\&quot;</span><span class="st">pdate</span><span class="dt">\&quot;</span><span class="st">&gt;</span><span class="va">$pdate</span><span class="st">&lt;/span&gt; - </span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="st">[</span><span class="va">$title</span><span class="st">](/posts/</span><span class="va">$plink</span><span class="st">)&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$ind</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="st">    Encontrado post </span><span class="dt">\&quot;</span><span class="va">$title</span><span class="dt">\&quot;</span><span class="st">, de </span><span class="va">$pdate</span><span class="st">, </span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="st">    marcado no assunto </span><span class="dt">\&quot;</span><span class="va">$tag</span><span class="dt">\&quot;</span><span class="st">. </span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;</span>  </span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;/div&gt;&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$ind</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Compiling tag index page.&quot;</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>  <span class="va">$ind</span>   <span class="dt">\</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span> <span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">/</span><span class="va">$tag</span><span class="st">/</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$ind</span> .txt<span class="va">)</span><span class="st">.html&quot;</span> <span class="dt">\</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   sidebar=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pageside)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    footer=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pagefoot)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   baseurl=<span class="st">&quot;..&quot;</span> <span class="at">-V</span> lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Finished populating tags,</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="st">Will now create the tags index.&quot;</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="st">title: </span><span class="dt">\&quot;</span><span class="st">Lista de assuntos</span><span class="dt">\&quot;</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="st">Assuntos (_tags_) classificam as postagens pelo conteúdo e pelo</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a><span class="st">estilo, em vez do gênero textual. Na maioria dos blogs, as </span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a><span class="st">_tags_ são usadas somente para classificar os artigos a fim de</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a><span class="st">gerar sugestões de páginas afins.</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a><span class="st">As _tags_ aqui indicadas são as que haviam sido geradas pelo</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a><span class="st">antigo site em WordPress. Infelizmente, muitas destas</span></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a><span class="st">estão repetidas devido a pequenos erros de digitação. Esta </span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a><span class="st">situação foi causada pela interface imperfeita do WordPress para</span></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="st">manipular categorias e tags, que muito dificultava a consulta </span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="st">das existentes.</span></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a><span class="st">Além disso, por um certo tempo eu mantive instalado no meu blog</span></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="st">o plug-in </span><span class="dt">\&quot;</span><span class="st">Commenters Can Add Tags</span><span class="dt">\&quot;</span><span class="st">, que foi abusado pelos</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a><span class="st">visitantes para criar muitas _tags_ absurdas ou até obscenas.</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a><span class="st">Com alguma dificuldade eu consegui remover a maioria destas</span></span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a><span class="st">antes de fazer o _upload_ da nova versão.</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a><span class="st">|:---:|:---:|:---:|&quot;</span> <span class="op">&gt;</span> <span class="va">$tagprefix</span>/index.txt</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> taglist.txt <span class="va">$tagprefix</span>/_taglist.txt </span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="at">-d</span><span class="st">&#39; &#39;</span> taglist.txt <span class="va">$tagprefix</span>/_taglist.txt <span class="op">&gt;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span>  <span class="st">&#39;s/ $//g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a><span class="fu">tr</span> <span class="at">-s</span> <span class="st">&quot; &quot;</span> <span class="op">&lt;</span> <span class="va">$tagprefix</span>/_index.txt <span class="op">&gt;</span> <span class="va">$tagprefix</span>/__index.txt</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$tagprefix</span>/__index.txt <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/$/ |/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="va">$tagprefix</span>/_index.txt <span class="kw">|</span> <span class="fu">tr</span> <span class="dt">\ </span> <span class="dt">\\</span>n <span class="kw">|</span> <span class="ex">column</span> <span class="at">-x</span> <span class="at">-c</span> 230 <span class="op">&gt;</span> <span class="va">$tagprefix</span>/__index.txt</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$tagprefix</span>/__index.txt <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a><span class="fu">tr</span> <span class="at">-s</span> <span class="st">&quot;\t&quot;</span> <span class="op">&lt;</span> <span class="va">$tagprefix</span>/_index.txt <span class="op">&gt;</span> <span class="va">$tagprefix</span>/__index.txt </span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$tagprefix</span>/__index.txt <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/\t/ /g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/  / /g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/^/| /g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/ |/\/index.html) |/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/| /| [/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/ /] /g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/|]/|/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/] /](/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/](|/ |/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="va">$tagprefix</span>/_index.txt <span class="op">&gt;&gt;</span> <span class="va">$tagprefix</span>/index.txt</span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a><span class="st">|:----:|----:|</span></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a><span class="st">| [Retornar aos posts](/posts/index.html) | [Retornar à home](/index.html) |</span></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;&gt;</span> <span class="va">$tagprefix</span>/index.txt</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Tag index prepared.</span></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a><span class="st">Will compile the tag index page...&quot;</span></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>  <span class="va">$tagprefix</span>/index.txt   <span class="dt">\</span></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>     <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span> <span class="va">$tagprefix</span>/index.html <span class="dt">\</span></span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   sidebar=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pageside)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    footer=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pagefoot)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   baseurl=<span class="st">&quot;..&quot;</span> <span class="at">-V</span> lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-z</span> <span class="st">&#39;s/&lt;table&gt;/&lt;table class=\&quot;back\&quot;&gt;/2&#39;</span> <span class="va">$tagprefix</span>/index.html <span class="op">&gt;</span> posts.htm</span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> posts.htm <span class="va">$tagprefix</span>/index.html</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Tag index compiled.&quot;</span></span></code></pre></div>
<p>You can ajust the column width in both scripts, if you need, to ensure that a corrent table is generated. The desired output is a three-column table in each case.</p>
<h3 id="fixed-pages-1">Fixed pages</h3>
<p>Fixed pages are quite easy to process, since they don’t have tags. It’s just a case of cycling through their filenames and processing each of them:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> page <span class="kw">in</span> <span class="kw">`</span><span class="fu">find</span> src/pages <span class="at">-type</span> f <span class="at">-iname</span> <span class="dt">\*</span>.md<span class="kw">`</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>       <span class="va">$page</span>  <span class="dt">\</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st">  ·  &quot;</span> <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span>     pages/<span class="st">&quot;</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$page</span> .md<span class="va">)</span><span class="st">.html&quot;</span> <span class="dt">\</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   sidebar=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pageside)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    footer=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pagefoot)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">-V</span>      textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>      headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   baseurl=<span class="st">&quot;..&quot;</span> <span class="at">-V</span> lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Static pages compiled successfully&quot;</span></span></code></pre></div>
<h3 id="blog-posts-1">Blog posts</h3>
<p>This is a quite time-consuming part of the compilation (after getting tags and cats). So much so that my current plans include a script to compile only the last “n” posts (a partial blog update). My own blog takes 144 seconds to compile all posts (they being so many).</p>
<p>The script itself isn’t much complicated, though:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Now we must compile the posts themselves,</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">This will take long time.&quot;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> blogpost <span class="kw">in</span> <span class="kw">`</span><span class="fu">find</span> src/posts <span class="at">-type</span> f <span class="at">-iname</span> <span class="dt">\*</span>.md<span class="kw">`;</span> <span class="cf">do</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">fdate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f1,2,3</span><span class="va">)</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="va">slug</span><span class="op">=</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Compiling </span><span class="va">$slug</span><span class="st">&quot;</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>  <span class="va">$blogpost</span> <span class="dt">\</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span>     posts/<span class="va">$slug</span><span class="st">&quot;.html&quot;</span> <span class="dt">\</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   sidebar=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pageside)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    footer=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pagefoot)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>      textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>      headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> published=<span class="st">&quot;</span><span class="va">$pdate</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   baseurl=<span class="st">&quot;..&quot;</span> <span class="at">-V</span> lang=<span class="st">&quot;pt&quot;</span>  <span class="kw">&amp;</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pid <span class="kw">in</span> <span class="va">$(</span><span class="bu">jobs</span> <span class="at">-p</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">wait</span> <span class="va">$pid</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> src/posts/ <span class="at">-type</span> f <span class="at">-iname</span> <span class="dt">\*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span> <span class="op">&gt;</span> manifest.txt</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> manifest.txt src/posts/manifest.txt</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Finished compilation of all post pages.&quot;</span></span></code></pre></div>
<p>I keep my full list as <code>posts/archive.html</code>. I do link to it from the landing page.</p>
<h3 id="archive-of-posts-by-year">Archive of posts by year</h3>
<p>This is one of the coolest things I have been able to do in shell script, which Jilles didn’t do (probably because he didn’t need or want to, as he didn’t do categories and tags either). This required quite a lot of tweaking before it worked. You will probably have to adjust the CSS very well before it looks good for you, but it <em>is awesome!</em></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="st">title: </span><span class="dt">\&quot;</span><span class="st">Página de índices</span><span class="dt">\&quot;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="st">|:--------------:|:-------------:|:---------------------:|</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="st">| [artigos por categoria](/</span><span class="va">$catprefix</span><span class="st">/index.html) | </span><span class="dt">\</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="st">[artigos por assunto](/</span><span class="va">$tagprefix</span><span class="st">/index.html) | [lista completa](</span><span class="va">$archive</span><span class="st">.html) |</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> posts/index.txt</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> blogpost <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> src/posts <span class="at">-type</span> f <span class="at">-iname</span> <span class="st">&quot;*.md&quot;</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 10<span class="va">)</span><span class="kw">;</span> </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="va">fdate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f1,2,3</span><span class="va">)</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="va">pyear</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%Y&#39;</span><span class="va">)</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="va">plink</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span>.html<span class="va">)</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-e</span> <span class="st">&quot;title: &quot;</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;:&#39;</span> <span class="at">-f2,3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;- &lt;b class=</span><span class="dt">\&quot;</span><span class="st">pdate</span><span class="dt">\&quot;</span><span class="st">&gt;</span><span class="va">$pdate</span><span class="st">&lt;/b&gt; - [</span><span class="va">$title</span><span class="st">](/posts/</span><span class="va">$plink</span><span class="st">)&quot;</span> <span class="op">&gt;&gt;</span> posts/index.txt</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$archive</span>/<span class="pp">*</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> Year <span class="kw">in</span> <span class="kw">`</span><span class="fu">cat</span> years.txt<span class="kw">`;</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="va">ind</span><span class="op">=</span><span class="va">$archive</span>/<span class="va">$Year</span>/index.txt</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="va">tmp</span><span class="op">=</span><span class="va">$archive</span>/<span class="va">$Year</span>/posts.txt</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$ind</span> <span class="va">$tmp</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$archive</span>/<span class="va">$Year</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$archive</span>/<span class="va">$Year</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a><span class="st">title: Artigos publicados em </span><span class="va">$Year</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> <span class="va">$ind</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> blogpost <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> src/posts/ <span class="at">-type</span> f <span class="at">-iname</span> <span class="va">$Year</span>-<span class="dt">\*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span><span class="va">)</span><span class="kw">;</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    <span class="va">fdate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f1,2,3</span><span class="va">)</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    <span class="va">plink</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span>.html<span class="va">)</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>    <span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%d/%m&#39;</span><span class="va">)</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-e</span> <span class="st">&quot;title: </span><span class="dt">\&quot;</span><span class="st">&quot;</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>    <span class="va">pyear</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%Y&#39;</span><span class="va">)</span></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;- &lt;b class=</span><span class="dt">\&quot;</span><span class="st">pdate</span><span class="dt">\&quot;</span><span class="st">&gt;</span><span class="va">$pdate</span><span class="st">&lt;b&gt; - [</span><span class="va">$title</span><span class="st">](/posts/</span><span class="va">$plink</span><span class="st">)&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$ind</span></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;Encontrado </span><span class="dt">\&quot;</span><span class="va">$title</span><span class="dt">\&quot;</span><span class="st">, de </span><span class="va">$pyear</span><span class="st">.&quot;</span>  </span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>       <span class="va">$ind</span>  <span class="dt">\</span></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>     <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st">  · &quot;</span> <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span>     <span class="va">$archive</span>/<span class="va">$Year</span>/index.html   <span class="dt">\</span></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   sidebar=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pageside)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    footer=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pagefoot)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="at">-V</span> lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a><span class="st">title: </span><span class="dt">\&quot;</span><span class="st">Arquivo do blog</span><span class="dt">\&quot;</span></span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$archive</span>/index.txt</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span></span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a><span class="st">|:----:|:----:|:----:|&quot;</span> <span class="op">&gt;</span> tab.txt</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> years.txt <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/^/(\/</span><span class="va">${archive}</span><span class="st">\//g&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/$/\/index.html)/g&#39;</span> <span class="op">&gt;</span> ylinks.txt</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> years.txt <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span> <span class="op">&gt;</span> xyears.txt</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> xyears.txt ylinks.txt <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/^/[/g&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/\t/]/g&#39;</span> <span class="op">&gt;</span> yyears.txt</span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> yyears.txt <span class="kw">|</span> <span class="ex">column</span> <span class="at">-x</span> <span class="at">-c</span> 120 <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/^/| /g&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/$/ |/g&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/\t/ | /g&#39;</span> <span class="op">&gt;&gt;</span> tab.txt</span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> tab.txt <span class="op">&gt;&gt;</span> <span class="va">$archive</span>/index.txt</span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> ylinks.txt yyears.txt</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>       <span class="va">$archive</span>/index.txt  <span class="dt">\</span></span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>     <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st">  · &quot;</span>  <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span>     <span class="va">$archive</span>/index.html   <span class="dt">\</span></span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   sidebar=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pageside)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    footer=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pagefoot)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="at">-V</span> lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/&lt;table&gt;/&lt;table class=&quot;years&quot;&gt;/g&#39;</span> <span class="va">$archive</span>/index.html</span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> tab.txt <span class="op">&gt;&gt;</span> posts/index.txt</span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>       posts/index.txt  <span class="dt">\</span></span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>     <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st">  · &quot;</span>  <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span>     posts/index.html   <span class="dt">\</span></span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   sidebar=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pageside)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    footer=<span class="st">&quot;</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$pagefoot)</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>  headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span> signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>    update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a>       <span class="at">-V</span>   baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="at">-V</span> lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="st">&#39;0,/&lt;table&gt;/{s/&lt;table&gt;/&lt;table class=&quot;blog-header&quot;&gt;/}&#39;</span> posts/index.html <span class="op">&gt;</span> posts.htm</span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> posts.htm posts/index.html</span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/&lt;table&gt;/&lt;table class=&quot;years&quot;&gt;/g&#39;</span> posts/index.html</span></code></pre></div>
<p>Here the archives are ready to be linked to from the homepage and the sidebar (which is their sole purpose, if I am not wrong).</p>
<h3 id="atom-feed">Atom feed</h3>
<p>Though site feeds are less important nowadays, since Google killed its Feedburner and Reader services, many people still use them to follow their favourite blogs. So I think it’s nice to provide at least one type of feed. I use an Atom feed because that was what Jilles used, but I will eventually find a way to do RSS 2.0 instead.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="va">feedbegin</span><span class="op">=</span><span class="kw">`</span><span class="fu">cat</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;feed xmlns=&quot;http://www.w3.org/2005/Atom&quot;&gt;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;id&gt;</span><span class="va">$baseurl</span><span class="st">/atom.xml&lt;/id&gt;</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;title&gt;</span><span class="va">$site_id</span><span class="st">&lt;/title&gt;</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;link href=&quot;/atom.xml&quot; rel=&quot;self&quot; /&gt;</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;link href=&quot;/&quot; /&gt;</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;updated&gt;</span><span class="va">$timestamp</span><span class="st">&lt;/updated&gt;</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="kw">`</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$feedbegin</span><span class="st">&quot;</span> <span class="op">&gt;</span> atom.xml</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="bu">printf</span> <span class="st">&quot;\n&quot;</span> <span class="op">&gt;&gt;</span> atom.xml</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> post <span class="kw">in</span> <span class="dt">\</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="va">$(</span><span class="fu">find</span> src/posts <span class="at">-type</span> f <span class="at">-iname</span> <span class="dt">\*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-ur</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 20<span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="va">date</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$post</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f</span> 1-3<span class="va">)</span> <span class="st">&#39;+%Y-%m-%d&#39;</span><span class="va">)</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;title: &quot;</span> <span class="va">$post</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="va">link</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$post</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/.md/.html/g&#39;</span><span class="va">)</span><span class="st">&quot;</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span> <span class="at">-n</span> 15 <span class="va">$post</span> <span class="kw">|</span> <span class="ex">pandoc</span> <span class="at">-f</span> markdown <span class="at">-t</span> html5 <span class="dt">\</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/atom.xml <span class="dt">\</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> link=<span class="va">$link</span> <span class="dt">\</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> timestamp=<span class="st">&quot;</span><span class="va">${date}</span><span class="st">T12:00:00Z&quot;</span> <span class="op">&gt;&gt;</span> atom.xml </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="bu">printf</span> <span class="st">&quot;\n&quot;</span> <span class="op">&gt;&gt;</span> atom.xml</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;/feed&gt;&quot;</span> <span class="op">&gt;&gt;</span> atom.xml</span></code></pre></div>
<p>I have actually made a few modifications to Jilles’ script, though it’s still much the same and uses the same template. However, as you can see, the resulting <code>atom.xml</code> file is not well-formatted. There’s a lot of room for improvements.</p>
<h3 id="sitemap">Sitemap</h3>
<p>Sitemaps are useful to get yourself a higher SEO ranking. This script is basically the same as Jilles’:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="va">sitemap</span><span class="op">=</span><span class="st">&quot;sitemap.xml&quot;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="va">timestamp</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> +<span class="st">&quot;%Y-%m-%dT%H:%M:%SZ&quot;</span><span class="va">)</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span><span class="fu"> url()</span> <span class="kw">{</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;&lt;url&gt;&lt;loc&gt;</span><span class="va">${baseurl}</span><span class="st">/</span><span class="va">$1</span><span class="st">&lt;/loc&gt;&lt;lastmod&gt;</span><span class="va">$timestamp</span><span class="st">&lt;/lastmod&gt;&lt;/url&gt;&quot;</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="va">robots</span><span class="op">=</span><span class="kw">`</span><span class="fu">cat</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="st">User-agent: *</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="st">Allow: *</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="st">Sitemap: /sitemap.xml</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="kw">`</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$robots</span><span class="st">&quot;</span> <span class="op">&gt;</span> robots.txt</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="va">header</span><span class="op">=</span><span class="kw">`</span><span class="fu">cat</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;&gt;</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="kw">`</span> </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$header</span><span class="st">&quot;</span> <span class="op">&gt;</span> <span class="va">$sitemap</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> page <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> pages <span class="at">-name</span> <span class="st">&quot;*.html&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/pages\///&#39;</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="va">$(</span><span class="ex">url</span> <span class="va">$page)</span> <span class="op">&gt;&gt;</span> <span class="va">$sitemap</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> post <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> posts <span class="at">-name</span> <span class="st">&quot;*.html&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/posts\///&#39;</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="va">$(</span><span class="ex">url</span> <span class="va">$post)</span> <span class="op">&gt;&gt;</span> <span class="va">$sitemap</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pcat <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> categorias <span class="at">-name</span> <span class="st">&quot;*.html&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/categorias\///&#39;</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="va">$(</span><span class="ex">url</span> <span class="va">$pcat)</span> <span class="op">&gt;&gt;</span> <span class="va">$sitemap</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ptag <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> assuntos <span class="at">-name</span> <span class="st">&quot;*.html&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/assuntos\///&#39;</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="va">$(</span><span class="ex">url</span> <span class="va">$ptag)</span> <span class="op">&gt;&gt;</span> <span class="va">$sitemap</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a><span class="bu">printf</span> <span class="st">&quot;&lt;/urlset&gt;\n&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$sitemap</span></span></code></pre></div>
<h2 id="uploading">Uploading</h2>
<p>After done the compilation, you only have to upload the generated content to your webserver, for which you will probably use your trusty FTP transfer utility or some <code>rsync</code> spell.</p>
<p>I have chosen to do that manually, instead of scripted, because of bad misfortunes I had in the past, using buggy <code>rsync</code> scripts which, instead of uploading my files to an empty directory in the cloud, instead <em>deleted</em> my local files so the two places were exact “mirrors” of each other (though not the way I wanted).</p>
<p>If you have too many images, the upload will take very long (my initial commit took almost one full hour), but for the text files it is very fast.</p>
<p>My preferred upload method is the mirroring command from <code>lftp</code>:</p>
<p><code>mirror -R localdir remotedir</code></p>
<p>Which you will invoke <em>after</em> logging into your FTP server using <code>lftp</code> and changing your local directory to your build root.</p>
<p>In case you didn’t change directory before logging in, you can still do it with the command <code>lcd</code>, which takes the full path (unless you are changing into a subdirectory of the current folder).</p>
<p>In <em>my case</em>, as an example, I do this:</p>
<pre><code>lftp -u myuser ftp.mydomain.com.br
cd ..
mirror -R -x templates -x src -x scripts --ignore-time public_html www</code></pre>
<p>One good thing about the “mirror” command in <code>lftp</code> is that it will only transfer the files which have changed. This means it will probably re-upload your entire set of HTML, as well as any files you have edited, but <em>not</em> if you add the <code>--ignore-time</code> switch, which instructs <code>lftp</code> to only upload files that have been added or which have changed in bytesize.</p>
<p>Recompiling your entire blog with the <code>do_posts.sh</code> script, for instance, will change the HTML files timestamp, but if no change has been made, the size in bytes may still be the same, which will prevent re-upload and save you bandwidth and time.</p>
<h2 id="to-be-added">To be added</h2>
<p><code>letmeblog</code> is mostly complete, at this point, as there is little I am <em>capable</em> of adding. However, some useful features it could use, and which you could help me build, are:</p>
<ul>
<li>Pagination, or “page navigation” for large content lists;</li>
<li>Next and previous posts;</li>
<li>Local search (a simple <code>grep</code> would suffice).</li>
</ul>
<p>Some features are going to be implemented or improved as soon as I find enough documentation:</p>
<ul>
<li>Improved <code>robots.txt</code>;</li>
<li>Improved <code>.htaccess</code>;</li>
<li>Fully functional atom feed;</li>
<li>Alternative RSS feed;</li>
</ul>
<p>Some other features are already in planning, but might be delayed, as they are too specific for my needs:</p>
<ul>
<li>PDF and EPUB generation for sets of files (“anthologies”);</li>
<li>CSS editing based on font embedding (currently <code>letmeblog</code> wants you manually edit your CSS files replacing font declarations if you change the font embedding link);</li>
<li>Social network links.</li>
</ul>
<p>You are invited to help me improve <code>letmeblog</code> whatever way you can.</p>
<h1 id="conclusion">Conclusion</h1>
<p>If you like this, visit me at <a href="http://letraseletricas.blog.br" class="uri">http://letraseletricas.blog.br</a>, find my social network places and help spread the word about my work as a fiction writer and translator.</p>
<p>Thank you for reading up to this point. I hope you can produce your own blog using my tool. But if you don’t, remember the old adage of the GNU gurus:</p>
<blockquote>
<p>THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.</p>
</blockquote>
<blockquote>
<p>IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.</p>
</blockquote>
<h2 id="legalese">Legalese</h2>
<p>Scripts licensed under the <a href="https://mit-license.org">MIT/Expat</a>.</p>
<p>Scripts <code>do_atom.sh</code> and <code>do_sitemap.sh</code>: Copyright © 1999-2020 by Jilles van Gurp</p>
<p>Other scripts and templates Copyright © 2021 José Geraldo Gouvêa</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Well, <em>in theory</em> you can do that, but Gutenberg goes out of its way to corrupt the content you paste. You actually spend more time reviewing your post than you would if you had just written it in Gutenberg already.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>For the purposes of this document, the term “build root” will be used for the working directory where you will compile your blog. If you are in Linux, like me, it’s useful to put the scripts and their content in a directory read by your local http server, so you can develop the blog live, before you upload it.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>I have actually tested the script with <code>zsh</code> and it worked just fine. In fact, the early development was in <code>zsh</code>. I only moved back to <code>bash</code> because I noticed that it is more strict in syntax validation, which means that, unless I use “bashisms”, a script that was developed and tested under <code>bash</code> is more likely to work with well under <code>zsh</code> than the other way around.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>I am not sure whether the script will work with non-gnu <code>sed</code>, but, afaik, it probably will.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>Don’t mind the thumbnails, they are already honoured by the scripts if you include a “coverImage” directive in your <code>yaml</code> metadata.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6" role="doc-endnote"><p>I don’t particularly love the Open Font Library, but… hey! They aren’t Google!<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7" role="doc-endnote"><p>Though the <code>atom.xml</code> and <code>sitemap.xml</code> link to html files, in practice they are produced by processing Markdown inputs, like everything else.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
