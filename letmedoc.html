<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="José Geraldo Gouvêa" />
  <title>Blogging With Markdown and Pandoc</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 50em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {  background-color: #f8f8f8; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ef2929; } /* Alert */
    code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #c4a000; } /* Attribute */
    code span.bn { color: #0000cf; } /* BaseN */
    code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4e9a06; } /* Char */
    code span.cn { color: #000000; } /* Constant */
    code span.co { color: #8f5902; font-style: italic; } /* Comment */
    code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
    code span.dt { color: #204a87; } /* DataType */
    code span.dv { color: #0000cf; } /* DecVal */
    code span.er { color: #a40000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #0000cf; } /* Float */
    code span.fu { color: #000000; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
    code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
    code span.ot { color: #8f5902; } /* Other */
    code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
    code span.sc { color: #000000; } /* SpecialChar */
    code span.ss { color: #4e9a06; } /* SpecialString */
    code span.st { color: #4e9a06; } /* String */
    code span.va { color: #000000; } /* Variable */
    code span.vs { color: #4e9a06; } /* VerbatimString */
    code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Blogging With Markdown and Pandoc</h1>
<p class="subtitle"><p>Automating generation of content for the web using Markdown as the source format, shell scripting as the driver and Pandoc as the backend.</p></p>
<p class="author">José Geraldo Gouvêa</p>
<p class="date">April 23th, 2021.</p>
</header>
<nav id="TOC" role="doc-toc">

</nav>
<h1 id="introduction">Introduction</h1>
<p>From early 2010 to early 2021 I had a blog titled “Letras Elétricas”, built upon WordPress, hosted at <a href="http://www.letraseletricas.blog.br" class="uri">http://www.letraseletricas.blog.br</a>, but I have recently been forced to ditch that reputable and foolproof <a href="https://en.wikipedia.org/wiki/Content_management_system">CMS</a> because it had become an ordeal to keep the website going. When I had to find another way to build and keep my site, I suddenly found that the existing solutions didn’t cater to my needs, so I was pressured to build my own tool, despite the fact that I am not proficient in programming and barely know the basics of shell scripting.</p>
<p>However, witness to the power of shell scripting, I was able to create my personal solution to blogging, which, in spite of being rather limited, can actually do what I needed the most: posts, fixed pages, categories, tags, archives, news feed, sitemap and dynamic landing page. That solution is this set of scripts which I have named <code>letmeblog</code>.</p>
<p>This document describes how I wrote these scripts, how they work and how they can be improved by the deft hands of someone who may know better.</p>
<h2 id="original-inspiration">Original inspiration</h2>
<p>The creation of <code>letmeblog</code> was inspired by the work of one <a href="https://github.com/jillesvangurp">Jilles van Gurp</a>, a Belgian programmer who bravely exported his WordPress blog into a set of <a href="http://markdownguide.org">Markdown</a> files because he wasn’t pleased with the way WordPress was handling his writing. He later found a way to convert his posts and pages to static HTML using <a href="http://www.pandoc.org">Pandoc</a> by John Mac Farlane. Everything I did was follow his footsteps, though, in all fairness, I had a rougher path to tread and a longer distance to cover:</p>
<ul>
<li>Jilles’ website features less than 100 pages and posts, while mine had a whooping 910 — which I eventually reduced to 810 by merging, deleting or archiving posts.</li>
<li>Back in 2010, when he exported his blog, there were WordPress plug-ins which handled importing, editing and exporting Markdown from within the Control Panel itself; but these have either been deleted from the plug-in database, become incompatible with newer WordPress versions or simply been abandoned by their creators.</li>
<li>When I finally made my mind that I must move away from WordPress; my blog was already faulty, unstable and dangerously heavyweight — it wasn’t easy to recover a recent and decent XML backup including all recent posts and comments, as my previous export file was missing some.</li>
<li>Jilles’ goals didn’t include sorting posts by categories or tags, nor did he mean to build neat post archive pages, so he could make do with fewer scripts and fewer pre and post processing of his source files.</li>
</ul>
<h2 id="why-the-name">Why the name</h2>
<p>The name <code>LEtmeblog</code> was chosen as an acronym for “Letras Elétricas tiny markdown blog”, in which “Letras Elétricas” is the name of <a href="https://www.letraseletricas.blog.br">my personal weblog</a>, for which I have written these compilation scripts, and the “e” was only added for <a href="https://literarydevices.net/euphony">euphony</a>.</p>
<h2 id="a-note-about-philosophy">A note about philosophy</h2>
<p>Most people want to have <strong>automated</strong> tools to perform tasks for them. Automation is cool and useful, of course, and I, myself, am the user of many such automated tools. However, when I am dealing with creative content, I happily give up automation for:</p>
<ol type="1">
<li><strong>Control</strong>,</li>
<li>Modularity,</li>
<li>Flexibility,</li>
<li><strong>Speed</strong>.</li>
</ol>
<p>Retaking control of my content was one of the key reasons why I left WordPress and eventually decided to create my own blogging way. In fact, I actually tried to use existing alternatives, like <a href="https://jekyllrb.com">Jekyll</a>, <a href="https://www.getzola.org">Zola</a> and <a href="https://blog.getpelican.com">Pelican</a>; but each of them had something to displease me or to stop me from using it:</p>
<ul>
<li><strong>Jekyll</strong> is based on a scripting language (Ruby) that’s not well integrated into <a href="https://www.archlinux.org">Arch Linux</a>. Jekyll depends on ruby “gems” that are not packaged in Arch, not even in the <a href="https://aur.archlinux.org">AUR</a> and some of them don’t even install any more. Also, using Jekyll would require learning a lot about the Ruby language, something that I shouldn’t need to do only because I wanted to blog.</li>
<li><strong>Zola</strong> had me trying to set it up for an entire day and I didn’t even see a proper homepage. Everything seems to work from inside a binary and the documentation, though existing, is far from easy to understand. I quickly reallised that I would have to learn a lot about Zola before I could even put my site back up. By the way, Zola also seems to be more a site engine than a generator and I wasn’t sure whether I’d be able to host it where I park my domain.</li>
<li><strong>Pelican</strong>, like Jekyll, depends on software (in this case <a href="https://pypi.org">Python modules</a> that’s not readily available in Arch Linux. I really love the idea of learning Python, since it’s so ubiquitious and useful, but, unfortunately, it is not a static site generator; it has to be hosted and it’s not that easy to find a web hosting service which will give you Python access. Anyway, the idea of having my site dynamically generated online had already made me cringe for years and I really wanted something different. I would have used Pelican if it could <em>generate</em> my site offline so I could upload it, but I decided not to even try hosting it.</li>
</ul>
<p>The reason why I wanted to so bad to generate my site offline and only then upload it was that, with WordPress, I was always under the impression that my content was locked up in a binary format (SQL database) prone to corruption and requiring frequent backups which used a lot of bandwidth and generated big downloads. Some of the tools to back up the database were proprietary or even required payment, and none of them gave me actual control of my content (as we’ll see). Using either Zola or Pelican would have hurt even more, because these being niche CMS software, they’d be less likely to have readily available backup and export plug-ins.</p>
<p>This sensation of being locked up only worsened after WordPress became incompatible with a number of old plug-ins which allowed easy Markdown import, export and integration. The new “Gutenberg” editor rubbed salt onto the wound, as it was now impossible to simply write content elsewhere and paste it into the editor.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Content lock-up is apparently becoming a trend, even in so-called “Open Source” software, like WordPress. And that’s intollerable because I want to keep my content <em>mine</em> in the first place.</p>
<p>In the later days of my blog hosted as a WordPress site, I had another annoyance which I couldn’t solve at all: every time I logged into the Control Panel there was an alert about my admin e-mail, asking me whether I still had access to the address &lt;contatoletraseletricas.blog.br&gt;, which I didn’t. WordPress then warned me that only through that email address I would be able to restore my password, if my site was hacked. That really scared me, because, no matter what I did, <em>I could not</em> change that administrator email in the Control Panel. I actually knew how to do it, I had found where to do it, I had made the change, but it never updated the page when I pressed the button and the “confirmation” email supposedly sent to new email address I had chosen would never arrive there (even in the spam folder). Therefore, WordPress slowly freaked me into the conclusion that I had to save my files ASAP to prevent total data loss, and that I should delete and recreate the installation to prevent theft of my identity and rights. However, if I had to go through all of this, why would I simply return to WordPress? I am not some Windows user who’s okay with the idea that periodically erasing and reinstalling everything is normal. Linux users don’t take that for granted. This computer of mine has <em>never</em> been formatted. In fact, this computer has inherited the same SSD and the HD from a former one. This system I am using hs been rolling for about six years in a row, without reinstalling, and my files have been on this same Seagate 1TB HD for four years. Whenever I’m convinced that I must erase and reinstall a system, I take that as an admission that system corrupts itself and is not able to protect my data.</p>
<p>Another problem with WordPress, which seems to be replicated in other platforms, including some that purport to use Markdown inputs, is that you don’t actually control the process by which the source file becomes a blog. There is a template, there are scripts you will host or run and there are some source files to be processed — but the actual conversion isn’t transparent and you can’t interfere easily with it.</p>
<p><code>letmeblog</code> addresses these concerns by splitting the generation of the website in a set of scripts which can be run separately, giving you control of what you generating at each step. Moreover, by allowing you to stop and restart compilation at any time, it saves you time and processing power as you can prevent the full execution of a command that will <em>not</em> generate the site cleanly.</p>
<p>Website content is <em>generated</em> from source files, that’s a given, but it should be <em>reusable</em>. Big players; like Google, Apple, Microsoft and Facebook; have their own in-house ways to process the data you provide and reuse it as they wish, but they want to lock the data you provide so <em>you</em> can’t use it at will. Markdown is a tiny step towards retaking control of my content, since I can use the same source file to generate different types of content. Eventually, I’ll migrate every single bit of content I have ever produced, so I can reuse and recombine it freely and at will. In a traditional, hosted blog, your content is rarely ever reusable. In fact, if you want to generate e-books or PDFs from your content, you have to keep a separate source file offline, in your computer, which creates a problem with versioning.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>With <code>letmeblog</code> you keep your content conveniently stored in Markdown files, which you can reprocess to create different HTML versions, as well as producing EPUB, PDF or even MS Word versions, if need arises. You can even keep your files versioned; using tools <code>git</code> or <code>subversion</code>; not to mention the ability to back it up using <code>rsync</code> as well. You can also write scripts to split and recombine your source files to create different outputs.</p>
<p>And finally there is the problem of <strong>speed</strong>, which was my second biggest concern about WordPress, as my blog was growing ever slower as it grew in size. Every new page or post I added seemed to increase the performance overhead, as the database had to be queried multiple times by the server. As more visitors came, server overhead made the site unusable for long periods of time, causing my visitor count to drop from almos 200 a day to less than 70.</p>
<p>A static website would have no such issues. Pages are served super-quickly, as there is little processing done server-side. Granted, I have lost the ability to actually track my visitors, or to store their comments, but both are blessings in disguise — especially that about comments, as most of these were spam anyway, and legit commentators often left garbage remarks which added little to the actual content. Social networks have largely replaced fora and comment systems, so there’s no point trying to keep such things in my blog.</p>
<p>Very soon people will regard comment systems more or less like “<a href="https://en.wikipedia.org/wiki/Guestbook">guestbooks</a>”, which used to be all the rage around the turn of the century, but are now some relic that no cool website actually uses prominently.</p>
<p>As for visitor count, social network impact is a much more useful thing to measure. It doesn’t matter, in terms of relevance, that 200-odd people have stumbled upon your site if most of them have not stayed and fewer will ever return.</p>
<p>Therefore, <code>letmeblog</code>, though it goes back to the olden days of static websites, is not actually dropping much in terms of actual usability. It only needs to be improved with new features (like page navigation, which is still sorely missing).</p>
<h2 id="licensing-issues">Licensing issues</h2>
<p><em>Most</em> of my scripts are <em>inspired</em> by Jilles’, but not identical to them. The exceptions are <code>do_atom.sh</code> and <code>do_sitemap.sh</code>, both of which are almost identical to Jilles’ originals.</p>
<p>All in all, Jilles’ site is compiled by a few commands he invokes from a <code>Makefile</code> (which I have opted not to use), while my blog is compiled by a set of fourteen separated scripts, which have to be run separately. I have developed my own scripts for most of the tasks and the similarities to be found don’t result from plagiarism, but from the very nature of Pandoc, which takes a limited set of command-line arguments. Even the template I use is a custom one, though I have taken some cues from Pandoc’s defaults, with a few hints from Jille’s one.</p>
<p>I do recognise that I have <em>built upon</em> his work quite a lot, and for that I duly give him credit, but I owe about as much to <a href="https://stackoverflow.com">Stackexchange</a>… if you know what I mean. That’s a moot point, anyway, since he had kindly licensed his work under the <a href="https://mit-license.org/">MIT/Expat license</a>, which is a <a href="https://www.gnu.org/licenses/copyleft.html">copyleft</a> license. Out of my own will, I would have rather used the <a href="https://www.gnu.org/licenses/licenses.html">GPL</a>, but, since Expat and GPL are compatible, it makes sense to keep his choice. Therefore, the scripts and templates here are provided under the MIT/Expat license, even the parts I developed autonomously.</p>
<h1 id="requirements">Requirements</h1>
<p>The scripts are quite simple and will probably work in any Linux distribution, as well as any POSIX-compliant operating system which features the packages listed below:</p>
<dl>
<dt>Pandoc</dt>
<dd>for markdown compilation;
</dd>
<dt><code>bash</code></dt>
<dd>to actually execute the commands;<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</dd>
</dl>
<dl>
<dt>GNU “coreutils”</dt>
<dd>for source files preprocessing;
</dd>
<dt><code>jq</code></dt>
<dd>to extract metadata from Markdown files;
</dd>
<dt>GNU <code>sed</code></dt>
<dd>for source file preprocessing and for some HTML post processing as well;<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>
</dd>
</dl>
<p>From “coreutils”, the commands actually used in the script are <code>basename</code>, <code>cat</code>, <code>column</code>, <code>cp</code>, <code>cut</code>, <code>date</code>, <code>echo</code>, <code>find</code>, <code>grep</code>, <code>ls</code>, <code>mkdir</code>, <code>mv</code>, <code>paste</code>, <code>printf</code>, <code>readlink</code>, <code>rm</code>, <code>seq</code>, <code>sort</code>, <code>source</code>, <code>stat</code>, <code>tail</code>, <code>tr</code>, <code>uniq</code> and <code>wc</code>.</p>
<p>Users of lightweight distributions of Linux (like Slitaz and Tiny Core) might not be able to run these scripts, as these distros ship “busybox” as a replacement for Coreutils, but your mileage may vary.</p>
<h1 id="blog-structure">Blog Structure</h1>
<p>This is not a “smart” content management system like WordPress and others: these scripts are only as “smart” as the user (and their creator). If you don’t understand the scripts and feed them unstructured information, they will either fail or mangle your source files. <strong>Be warned!</strong></p>
<p>Unless you make changes to the scripts (which you are by all means invited to do if you know what you are doing), they depend on a given directory structure, created in the directory where you will keep your “build root”:</p>
<ul>
<li><code>templates</code> : the HTML template and a few other snippets;</li>
<li><code>src/pages</code> : for fixed pages, like “About”, “History” etc;</li>
<li><code>src/posts</code> : for the dynamic content;</li>
<li><code>images</code> : full-size pictures;</li>
<li><code>posts</code> : empty directory to receive the posts HTML;</li>
<li><code>pages</code> : empty directory to receive the pages HTML;</li>
<li><code>tags</code> : empty directory to receive the tags dirs;</li>
<li><code>categories</code> : empty directory to receive the category dirs;</li>
<li><code>archives</code> : empty directory to host the archives;</li>
<li><code>scripts</code>: where you’ll put the shell scripts.</li>
</ul>
<p>Though I have not yet fully implemented the concept, some of these directories support name customisation by changing lines in the <code>site_vars.sh</code> file.</p>
<h2 id="scripts-folder"><code>scripts</code> folder</h2>
<p>Blog building system is made up of fourteen shell scripts, which you will put into a <code>scripts</code> directory under the build root:</p>
<ol type="1">
<li><code>get_cats.sh</code></li>
<li><code>get_tags.sh</code></li>
<li><code>get_years.sh</code></li>
<li><code>set_recent.sh</code></li>
<li><code>set_pinned.sh</code></li>
<li><code>do_home.sh</code></li>
<li><code>do_cats.sh</code></li>
<li><code>do_tags.sh</code></li>
<li><code>do_pages.sh</code></li>
<li><code>do_posts.sh</code></li>
<li><code>do_blogfull.sh</code></li>
<li><code>do_archives.sh</code></li>
<li><code>do_atom.sh</code></li>
<li><code>do_sitemap.sh</code></li>
</ol>
<p>Scripts up to #5 are preprocessing steps (the first don’t have to be run every time you update the blog).</p>
<p>Scripts from #6 to #12 are compilation steps and should be always run whenever you: - Create a new post; - Categorise to a post; - Tag a post; - Remove a post from a category; - Remove a tag from a post; - Create a new tag or delete one that existed; - Create a new category or delete one that existed.</p>
<p>If you are unsure about the order you should run the scripts, use the mnemonic: “get, set, do”. Never run a “set” script before you have run all that “get”, never run a “do” script before running a “set” script. “Get” scripts only need to be run when you first build the blog, after that you can maintain their output by hand. “Set” scripts only need to be run when you add a new post or if you decide to change the pinned post. “Do” scripts need to be run every time you add content. Run <code>do_atom.sh</code> if you add posts. Run <code>do_sitemap.sh</code> if you add posts <em>or</em> pages. You must run both if you <em>rename</em> pages or posts.</p>
<p>Unless otherwise specified, the scripts don’t take arguments nor have options. Simply run them from the build root:<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p><code>sh scripts/do_home.sh</code></p>
<p>Other than that, you have two specific scripts:</p>
<ol type="1">
<li><code>update_post.sh</code></li>
<li><code>update_template.sh</code></li>
</ol>
<p><code>update_post.sh</code> is to recompile one single post, if you notice some problem specific to it. You can also use it instead of the <code>do_posts.sh</code> script to compile a single post if you are sure that the rest of the contents will not be affected.</p>
<p>Usage: <code>sh scripts/update_post.sh src/posts/XXXX-XX-XX-postname.md</code></p>
<p>The script will silently and gently generate the HTML output in the <code>posts/</code> directory.</p>
<p><code>update_template.sh</code> is to regenerate the HTML template if you make changes to its parts. You will know why this is useful later in this document.</p>
<p>The scripts all rely on a file called <code>site_vars.sh</code> which must be put into the scripts directory. Your website will only compile if you provide <em>all</em> following varibles in the format <code>variable_name=\"variable_vale\"</code>.</p>
<dl>
<dt><code>site_id</code></dt>
<dd>Your cool blog name.
</dd>
<dt><code>site_desc</code></dt>
<dd>A pithy quote to adorn your header. By default it comes <em>below</em> the site name.
</dd>
<dt><code>baseurl</code></dt>
<dd>Though most links are <em>relative</em>, some scripts need to know the domain to access your site online.
</dd>
<dt><code>author</code></dt>
<dd>Your full name, under which all legal stuff should be filed.
</dd>
<dt><code>signature</code></dt>
<dd>Your public name, the one readers will see in the header.
</dd>
<dt><code>first_year</code></dt>
<dd>The foundation year of your blog.
</dd>
<dt><code>catprefix</code></dt>
<dd>The name you’ll give to your blog categories. Useful for localisation, for instance, but you can use it to give your categories some fancy name as well.
</dd>
<dt><code>tagprefix</code></dt>
<dd>The name you’ll give to your blog tags. Useful for localisation, for instance, but you can use it to give your tags some fancy name as well.
</dd>
<dt><code>archive</code></dt>
<dd>The name you’ll give to your archive directory (posts filed by year).
</dd>
<dt><code>fonturl</code></dt>
<dd>The service provider for your custom fonts. I like to use the <a href="https://fontlibrary.org">Open Font Library</a>. To use them you put <code>\"https://fontlibrary.org/face/\"</code> here.
</dd>
<dt><code>textfont</code></dt>
<dd>The font used to format the text in your pages. As a former user of <a href="http://tug.org">LaTeX</a>, I like to use “cmu-concrete” for body copy. It’s wide, clear, old-fashioned a bit odd.
</dd>
<dt><code>headfont</code></dt>
<dd>The font used to format the your headings. As a former user of <a href="http://tug.org">LaTeX</a>, I like to use “cmu-bright” for body copy. It’s wide, clear, old-fashioned a bit odd.
</dd>
<dt><code>fontenctxt</code></dt>
<dd>Information that needs to be suffixed to the font face name for the textfont. If you use the Open Font Library, don’t add this, or leave it blank. Google Fonts require this.
</dd>
<dt><code>fontenchdr</code></dt>
<dd>Information that needs to be suffixed to the font face name for the header font. If you use the Open Font Library, don’t add this, or leave it blank. Google Fonts require this.
</dd>
<dt><code>panopts</code></dt>
<dd>A set of instructions and options to be passed on to Pandoc at compile time. I have settled for <code>markdown+smart+yaml_metadata_block+implicit_figures</code>, but you can change it if you wish.
</dd>
</dl>
<p>Besides the variables above, which are all custom, the following are not meant to be changed at all. Just copy-paste these there and never change them, unless you know <em>very well</em> what you are doing. You can change them if you notice that I have changed them in the documentation as well:</p>
<pre><code>this_year=$(date &#39;+%Y&#39;)
postcount=$(find src/posts -name \*.md | wc -l)
tagcount=$(cat taglist.txt | wc -l)
catcount=$(cat catlist.txt | wc -l)
last_post=$(find src/po*/$this_year-*.md -type f|tail -n 1)
update=$(date -r $last_post &#39;+%d de %B de %Y às %H:%M&#39;)</code></pre>
<h2 id="src-folder"><code>src</code> folder</h2>
<p>The blog source tree (<code>src/</code>) keeps the landing page info (<code>src/index.md</code>), blog posts (<code>src/posts/</code>) and fixed pages (<code>src/pages/</code>). Throughout the source tree, Markdown files (suffix <code>.md</code>) are the content you write and plain text files (suffix <code>.txt</code>) are produced by scripts processing your content, throughout the many phases of compilation, and HTML files (suffix <code>.html</code>) are the output content produced by Pandoc.</p>
<p>All site content must be writting in Markdown. You can use any Markdown features supported by Pandoc (do read their documentation and add the required extension code to <code>src/site_vars.sh</code>). The default Pandoc invocation I use is <code>markdown+smart+yaml_metadata_block+implicit_figures</code>, which means “Pandoc’s own markdown dialect, extended with smart punctuation, yaml metadata blocks and putting images in a ‘figure’ environment by default”. I find this setup pretty basic, but powerful enough to provide good quality. Unless you need something specific, like MathML, LaTeX output etc., there is no need to change it.</p>
<h3 id="landing-page">Landing page</h3>
<p>The default landing page contains three blocks of content:</p>
<dl>
<dt>Site greeting</dt>
<dd>read from the <code>index.md</code> which you write in the source tree.
</dd>
<dt>Pinned content</dt>
<dd>which is compiled from a post or page you have symlink to <code>pinned.md</code> in the build root.
</dd>
<dt>Recent posts</dt>
<dd>compiled from a file called <code>recent.txt</code> created in the build root previously to compilation.
</dd>
</dl>
<p>Any content you write to the <code>index.md</code> file will appear at the top of the landing page in a larger font.</p>
<p>If you delete (or never create) a <code>pinned.md</code> file, the landing page will not have a pinned content area.</p>
<p>Anything else you want to change (or if you want to add content after the recent posts), you must change the script that compiles the homepage.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<h3 id="fixed-pages">Fixed pages</h3>
<p>Fixed pages have plain names, preferably short and easy to memorise — like <code>bio.md</code>, <code>about.md</code>, <code>blogroll.md</code>, etc. These names will result in URLs like <code>http://baseurl/pages/bio.html</code>, which are meant to be easy to be remember. Whatever really important information should have such URLs, but they must be used sparingly, as pages don’t organise content.</p>
<h3 id="blog-posts">Blog posts</h3>
<p>Blog posts must be written in Markdown and named according to <code>YYYY-MM-DD-post-title.md</code>; in which <code>YYYY</code> is the year written as four digits (e.g. “2021”), <code>MM</code> is the month in two digits (e.g. from “01” to “12”) and <code>DD</code> is the day in two digits (from “01” to “31”). The date must be written with hyphens to keep the URL working. Words in the filename can be separated by either hyphens or underscores (as you wish, but <em>not</em> by spaces or special characters other than these). The <code>YYYY-MM-DD</code> block must be separated from the title by a hyphen.</p>
<p>These are valid blog post file names:</p>
<pre><code>2021-11-16-a-trip-to-london.md
2021-11-16-A-Trip-To-London.md
2021-11-16-A_Trip_to_London.md
2021-11-16-a_trip_to_london.md
2021-11-16-a_trip-to_london.md</code></pre>
<p>But these aren’t (if you’re even able to create files named as such in your system, which you may not be, I’m afraid):</p>
<pre><code>2021_11_16_a_trip_to_london.md 
2021-11-16-a trip to london.md
2021-11-16-a%trip%to%london.md
2021/11/16-a*trip*to*london.md
2021-16-11-a-trip-to-london.md</code></pre>
<p>The last one will not spit an error, but will result in gibberish because there is no 16^th month.</p>
<h4 id="post-metadata">Post metadata</h4>
<p>Post metadata shall be written in <code>yaml</code> format and included in the <em>beginning</em> of the file. In theory, a metadata block can be included anywhere in the post, but for the sake of clarity and organisation it’s already better to put it there. For the purpose of this script, putting a <code>yaml</code> block elsewhere <em>may</em> not harm the output, but will be ignored at best.</p>
<p>The scripts need at least “title” and “date” to generate the blog without issues. If you won’t use categories and tags, you may not include them in the sources, but there’s really no point in refusing to use them, as they are so darn useful.</p>
<p>You can include a “toc” metadata (either “true” or “false”), in really long pages or posts, with many sub-headings. I have prepared the scripts to recognise the “toc” metadata and proceed accordingly.</p>
<p>You can also include a “coverImage” metadata, pointing to an image file. The script will use this image file as the thumbnail shown in some post lists.</p>
<p>Any other metadata declarations will <em>probably</em> be ignored, but aren’t safe to include, unless you know well how Pandoc handles them. I don’t claim to be an expert in that particular matter.</p>
<h4 id="post-formatting">Post formatting</h4>
<p>All content is just <a href="http:markdownguide.org">Markdown</a>, which you probably know what is at this point. If you don’t, do take some time to read some documentation about the format. If you don’t need much in terms of formatting, you’ll probably do well with the most basic knowledge, that is:</p>
<ul>
<li>Write plain text in a text editor, not in Word or whatever that is even remotely similar to Word;</li>
<li>Blocks of text separated by empty lines make paragraphs;</li>
<li>Emphasise passages using asterisks (one for italics, two for boldened text);</li>
<li>Subheadings are made using hashes (up from two to six, as you go deeper in subheading nesting), but don’t use one hash only (as in <code># Heading 1</code>) because the first-level heading is reserved for the post title, which is given by the <code>yaml</code> metadata block.</li>
</ul>
<p>If you need more than this, then you <strong>do</strong> need to read the full documentation.</p>
<h4 id="images">Images</h4>
<p>To keep the build tree tidy you should create an <code>images</code> folder in the root directory and put all images there. There’s no specification for image format, of course, but my experience is that JPGs are better for detailed images that will appear at a bigger size and PNG files are better for everything else.</p>
<p>The reason why I prefer JPGs for big images isn’t quality, but bandwidth saving as they have better (lossy) compression for photographs. Ideally, you should resize all images down to 100% of the minimum width of your text area. That way you don’t use too much transfer bandwidth with images that are bigger than absolutely necessary.</p>
<h2 id="templates-folder"><code>templates</code> folder</h2>
<p>Pandoc will build the site from a set of templates, which you can customise, of course. The main HTML template (filename <code>blog.html</code>) is generated by the <code>update_template.sh</code> script, from the following files:</p>
<ol type="1">
<li><code>head1.tpl</code></li>
<li><code>head2.tpl</code></li>
<li><code>head3.tpl</code></li>
<li><code>head4.tpl</code></li>
<li><code>head5.tpl</code></li>
<li><code>head6.tpl</code></li>
<li><code>body.tpl</code></li>
</ol>
<p>These files are not meant to be edited, unless you know well what you are doing and why. Their different functions are explained further down.</p>
<p>The actual templates you want to customise are called <code>sbar.txt</code>, <code>social.txt</code> and <code>foot.txt</code>. Other than that, don’t change anything in the templates (unless you know what you are doing). Just edit the variables file (<code>site_vars.sh</code>) in the <code>scripts</code> directory and that will be used to fill in the placeholders.</p>
<p><code>social.txt</code> : is your social links section, where you will add links to your social network profiles.</p>
<p><code>sbar.txt</code> : is your navigation section, where you will write your navigation links and any other content you want to put in your sidebar or menu.</p>
<p><code>footer.txt</code> : contains your copyright claim (if any) as well as any messages you want to appear below every page.</p>
<h3 id="the-html5-template">The HTML5 template</h3>
<p>The default Pandoc HTML5 template is pretty basic and nothing much needs to be changed in it, unless you know very well what you are doing.</p>
<p>The beginning part is especially unchangeable:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;html</span><span class="er">$if(lang)$</span> <span class="er">lang</span><span class="ot">=</span><span class="st">&quot;$lang$&quot;</span><span class="er">$endif$$if(dir)$</span> <span class="er">dir</span><span class="ot">=</span><span class="st">&quot;$dir$&quot;</span><span class="er">$endif$</span><span class="kw">&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;head&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;title&gt;</span>$title$<span class="kw">&lt;/title&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;meta</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;generator&quot;</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;pandoc&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;meta</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;viewport&quot;</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="kw">&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;meta</span> <span class="er">http-equiv</span><span class="ot">=</span><span class="st">&quot;Content-Type&quot;</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;text/html; charset=utf-8&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>$for(author-meta)$</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;meta</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;author&quot;</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;$author-meta$&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>$endfor$</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>$if(date-meta)$</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;meta</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;dcterms.date&quot;</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;$date-meta$&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>$endif$</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>$if(description)$</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;meta</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;description&quot;</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;$description$&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>$endif$</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>$if(tags)$</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;meta</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;keywords&quot;</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;$for(tags)$$tags$$sep$, $endfor$&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>$endif$</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;meta</span> <span class="er">property</span><span class="ot">=</span><span class="st">&quot;og:type&quot;</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;website&quot;</span> <span class="kw">/&gt;</span></span></code></pre></div>
<p>Now comes styling. I have used open-source fonts from the <a href="https://fontlibrary.org">Open Font Library</a> and the scripts expect them, but you can pick any fonts you want, you just need to adjust the template and the stylesheets. If you plan to use fonts from OFL as I did, put their names in the <code>site_vars.sh</code> file as the “text” and “head” variables and then follow the guidelines for font-face choosing, which are found in the CSS files themselves.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Font Stylesheets --&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;screen&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;$fonturl$/$textfont$$fontenctxt$&quot;</span> <span class="er">type</span><span class="ot">=</span><span class="st">&quot;text/css&quot;</span><span class="kw">/&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>$if(headfont)$</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;screen&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;$fonturl$/$headfont$$fontenchdr$&quot;</span> <span class="er">type</span><span class="ot">=</span><span class="st">&quot;text/css&quot;</span><span class="kw">/&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>$endif$</span></code></pre></div>
<p>Local style sheets will hold your actual styles. I have preset four style files, loaded in this specific order, so that they “cascade” as expected, resulting in a consistent and responsive layout.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Local Stylesheets --&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;screen&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/common.css&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;only screen and (max-width: 599px)&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/mobile.css&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;only screen and (min-width: 600px)&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/desktp.css&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;stylesheet&quot;</span> <span class="er">media</span><span class="ot">=</span><span class="st">&quot;screen&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/content.css&quot;</span> <span class="kw">/&gt;</span></span></code></pre></div>
<p>The two last things are the link to the Atom Feed (a pretty basic one) and to the Font Awesome kit providing the basic icons. <em>I use them</em>, the setup is free and there’s no real reason not to use Font Awesome, unless you absolutely don’t know what to do with it. At this moment, I only use five of their icons, to build the Creative Commons licensing at the footer and to create a warning icon I use in some places, but I will use Font Awesome more often in actual <em>post content</em>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;atom.xml&quot;</span> <span class="er">type</span><span class="ot">=</span><span class="st">&quot;application/atom+xml&quot;</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;alternate&quot;</span> <span class="er">title</span><span class="ot">=</span><span class="st">&quot;Sitewide Atom feed&quot;</span> <span class="kw">/&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We&#39;re using FontAwesome, though we don&#39;t know much about what we can do with it --&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;https://kit.fontawesome.com/a64519a0e0.js&quot;</span> <span class="er">crossorigin</span><span class="ot">=</span><span class="st">&quot;anonymous&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span></code></pre></div>
<p>Before the actual page content there are two more bits to add, the site header and the sidebar/menu.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;site-name&quot;</span><span class="kw">&gt;&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/&quot;</span> <span class="er">title</span><span class="ot">=</span><span class="st">&quot;$site_id$&quot;</span> <span class="er">rel</span><span class="ot">=</span><span class="st">&quot;home&quot;</span><span class="kw">&gt;</span>$site_id$<span class="kw">&lt;/a&gt;&lt;/div&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;site-description&quot;</span> <span class="er">title</span><span class="ot">=</span><span class="st">&quot;$site_desc$&quot;</span><span class="kw">&gt;</span>$site_desc$<span class="kw">&lt;/div&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;site-data&quot;</span><span class="kw">&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;span</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;byline&quot;</span> <span class="er">title</span><span class="ot">=</span><span class="st">&quot;$author$&quot;</span><span class="kw">&gt;</span>by $signature$<span class="kw">&lt;/span&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;span</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;update&quot;</span><span class="kw">&gt;</span>$updmsg$<span class="kw">&lt;span</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;date&quot;</span><span class="kw">&gt;</span>$update$<span class="kw">&lt;/span&gt;&lt;/span&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<p>The sidebar (not part of the template, but a custom input file that you must write yourself) is actually a misnomer, as this is where navigation goes. It can be either a sidebar, if you are a conservative, like me, be styled in the most outlandish way you wish. Know your CSS and make it your way.</p>
<p>The main content area in the template is the same for both posts and pages: there are conditions put in place that will format the output depending on the presence or absence of certain variables. By default the publish date, the tags and categories variables are not evoked by the page compilation script, only by the article compilation; so, it doesn’t matter if you add tags and publish dates to a page, they won’t appear anywhere.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;main&quot;</span><span class="kw">&gt;&lt;h1</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;header&quot;</span><span class="kw">&gt;</span>$title$<span class="kw">&lt;/h1&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;main-content&quot;</span><span class="kw">&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        $if(published)$</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>          <span class="kw">&lt;div</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;published&quot;</span><span class="kw">&gt;</span>Publicado em: $published$<span class="kw">&lt;/div&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        $endif$</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        $if(abstract)$</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;div</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;intro&quot;</span><span class="kw">&gt;</span>$abstract$<span class="kw">&lt;/div&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        $endif$</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        $if(toc)$</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;TOC&quot;</span> <span class="er">role</span><span class="ot">=</span><span class="st">&quot;doc-toc&quot;</span><span class="kw">&gt;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;b</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;toc-title&quot;</span><span class="kw">&gt;</span>Sumário<span class="kw">&lt;/b&gt;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        $table-of-contents$</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;/div&gt;</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        $endif$</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>              $body$</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        $if(published)$</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>          <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;context&quot;</span><span class="kw">&gt;</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;a</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;fas fa-arrow-left&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;$aftr$&quot;</span><span class="kw">&gt;&lt;/a&gt;</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;a</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;newer&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;$aftr$&quot;</span><span class="kw">&gt;</span>seguinte<span class="kw">&lt;/a&gt;</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;span</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;expander fas&quot;</span><span class="kw">&gt;&lt;/span&gt;</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;a</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;older&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;$befo$&quot;</span><span class="kw">&gt;</span>anterior<span class="kw">&lt;/a&gt;</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;a</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;fas fa-arrow-right&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;$befo$&quot;</span><span class="kw">&gt;&lt;/a&gt;</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>          <span class="kw">&lt;/div&gt;</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        $endif$</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        $if(published)$</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;categories&quot;</span><span class="kw">&gt;&lt;b&gt;</span>Arquivado em: <span class="kw">&lt;/b&gt;</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>              $for(categories)$</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>              <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/categorias/$categories$/index.html&quot;</span><span class="kw">&gt;</span>$categories$<span class="kw">&lt;/a&gt;</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>              $endfor$</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;/div&gt;</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;div</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;tags&quot;</span><span class="kw">&gt;&lt;b&gt;</span>Assuntos: <span class="kw">&lt;/b&gt;</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>              $for(tags)$</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>              <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;/assuntos/$tags$/index.html&quot;</span><span class="kw">&gt;</span>$tags$<span class="kw">&lt;/a&gt;</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>              $endfor$</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>            <span class="kw">&lt;/div&gt;</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        $endif$</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/div&gt;</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<p>And finally comes the footer area, which will just print the contents of your footer file.</p>
<h3 id="the-social.txt-input-file">The <code>social.txt</code> input file</h3>
<p>This is a <code>div</code> with the <code>social</code> id, which must be put in your templates folder. Inside the <code>div</code> you add any number of html anchor links pointing to your social networks. Style them as you wish. I use FontAwesome. Example:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">style</span><span class="ot">=</span><span class="st">&quot;text-align: right&quot;</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;social&quot;</span><span class="kw">&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;fab fa-twitter&quot;</span> <span class="er">target</span><span class="ot">=</span><span class="st">&quot;_blank&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;https://twitter.com/YOURPROFILE&quot;</span><span class="kw">&gt;&lt;/a&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;fab fa-telegram&quot;</span> <span class="er">target</span><span class="ot">=</span><span class="st">&quot;_blank&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;https://t.me/YOURPROFILE&quot;</span><span class="kw">&gt;&lt;/a&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;fab fa-facebook&quot;</span> <span class="er">target</span><span class="ot">=</span><span class="st">&quot;_blank&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;https://www.facebook.com/YOURPROFILE&quot;</span><span class="kw">&gt;&lt;/a&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;a</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;fab fa-github&quot;</span> <span class="er">target</span><span class="ot">=</span><span class="st">&quot;_blank&quot;</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;https://github.com/YOURPROFILE&quot;</span><span class="kw">&gt;&lt;/a&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
<h3 id="the-sbar.txt-input-file">The <code>sbar.txt</code> input file</h3>
<p>You can structure your navigation any way you want, but I advise you to base it on the following elements, to make CSS styling a bit easier:</p>
<ul>
<li><p><code>&lt;div role="navigation" class="navigation"&gt;</code> : where you will put your main links in an <code>&lt;ul class="menu"&gt;</code></p></li>
<li><p><code>&lt;div class="bloglinks"&gt;</code> : for links of lesser importance, also in an <code>&lt;ul class="links"&gt;</code></p></li>
<li><p><code>&lt;div class="widget"&gt;</code> : for any other element which is not a link.</p></li>
</ul>
<h3 id="the-footer.txt-input-file">The <code>footer.txt</code> input file</h3>
<p>You can put anything in your footer, but I advise you to include, at least, your copyright information (<code>&lt;div id="license"&gt;</code>) separated from random site info (<code>&lt;p id="site-info"&gt;</code>). My own site has the following information in the footer:</p>
<ul>
<li>CC-BY-ND-SA (icons) Creative Commons Attribution Non-Derivative Share-Alike license tag (with the respective link).</li>
<li>An appeal for correct content attribution.</li>
<li>An explanation about the use of Markdown and Pandoc to compile the site and an attribution to Jilles van Gurp for inspiration.</li>
<li>Mention of the Open Font Library, where the fonts are hosted.</li>
<li>Links to the code repository.</li>
</ul>
<h1 id="processing-the-blog">Processing the blog</h1>
<p>Blog processing is done in stages:</p>
<ol type="1">
<li>Content creation (don’t start if you have nothing to post.);</li>
<li>Folder setup (<code>mkdir</code> the places you will use, <code>chmod</code> the directories, <code>symlink</code> them, if need, edit the webserver config if you plan to develop live etc.);</li>
<li>Variables setup (edit the <code>site_vars.sh</code> script);</li>
<li>Preprocessing;</li>
<li>Compilation;</li>
<li>Upload.</li>
</ol>
<p>This document is about steps 3 to 5. The first one you must do on your own (I can’t provide any advice on that), the second has been explained <a href="#folders">above</a> and the last one each user will choose to do differently.</p>
<h2 id="setting-up-site-variables">Setting up site variables</h2>
<p>The file <code>site_vars.sh</code> stores a series of variables that will be read by every other script from now on. You <strong>must</strong> edit it before anything else. I have provided a blank one, that you need to fill in. <em>Every variable is required</em>, though they some can have blank values.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="va">site_id</span><span class="op">=</span><span class="st">&quot;Your site name&quot;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="va">site_desc</span><span class="op">=</span><span class="st">&quot;A pithy quote to adorn your header&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="va">baseurl</span><span class="op">=</span><span class="st">&quot;The domain you have hosted&quot;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="va">author</span><span class="op">=</span><span class="st">&quot;Your full name&quot;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="va">signature</span><span class="op">=</span><span class="st">&quot;the name by which you want to be known&quot;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="va">updmsg</span><span class="op">=</span><span class="st">&quot;something like </span><span class="dt">\&quot;</span><span class="st">Updated on: </span><span class="dt">\&quot;</span><span class="st"> will do&quot;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="va">first_year</span><span class="op">=</span>YEAR <span class="co"># Without quotes, when you began your blog.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="va">this_year</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="st">&#39;+%Y&#39;</span><span class="va">)</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace catprefix and tagprefix with your localized names or</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># the fancy names you want them to be known by.</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="va">catprefix</span><span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="va">tagprefix</span><span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="va">archive</span><span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># We&#39;ll extract some information that will be used in the templates:</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># a) how big is my blog directory? how many posts in there?</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="va">postcount</span><span class="op">=</span><span class="va">$(</span><span class="fu">ls</span> src/posts/<span class="pp">*</span>-<span class="pp">*</span>.md <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span><span class="va">)</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co"># b) how many tags do we have? This variable only works after</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co"># you have run `get_tags.sh` once and its results are only</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># reliable if you keep an eye on your taglist.</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="va">tagcount</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> taglist.txt <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span><span class="va">)</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co"># c) how many categories? This variable only works after</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co"># you have run `get_cats.sh` once and its results are only</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co"># reliable if you keep an eye on your catlist.</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="va">catcount</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> catlist.txt <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span><span class="va">)</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co"># d) when did I post for the last time?</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="va">last_post</span><span class="op">=</span><span class="va">$(</span><span class="fu">stat</span> <span class="at">-c</span> <span class="st">&quot;%w&quot;</span> <span class="va">$(</span><span class="fu">find</span> src/posts/<span class="va">$this_year</span>-<span class="pp">*</span>.md <span class="at">-type</span> f<span class="va">)</span> <span class="kw">|</span> <span class="fu">tail</span> <span class="at">-n</span> 1 <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39; &#39;</span> <span class="at">-f1</span><span class="va">)</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="va">last_time</span><span class="op">=</span><span class="va">$(</span><span class="fu">stat</span> <span class="at">-c</span> <span class="st">&quot;%w&quot;</span> <span class="va">$(</span><span class="fu">find</span> src/posts/<span class="va">$this_year</span>-<span class="pp">*</span>.md <span class="at">-type</span> f<span class="va">)</span> <span class="kw">|</span> <span class="fu">tail</span> <span class="at">-n</span> 1 <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39; &#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="va">update</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$last_post</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonts for text and headlines</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Wherey they are hosted</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="va">fonturl</span><span class="op">=</span><span class="st">&quot;https://fontlibrary.org/face/&quot;</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="co"># What are their names</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="va">textfont</span><span class="op">=</span><span class="st">&quot;cmu-concrete&quot;</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="va">headfont</span><span class="op">=</span><span class="st">&quot;cmu-bright&quot;</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Details after the name (Fontlibrary doesn&#39;t need any)</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="va">fontenc</span><span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="co"># But exactly how will I evoke pandoc</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="va">panopts</span><span class="op">=</span><span class="st">&quot;markdown+smart+yaml_metadata_block+implicit_figures&quot;</span></span></code></pre></div>
<p>Having set up your varibles, time to move on to actually building your blog, which you <em>should</em> do in the following order:</p>
<h2 id="preprocessing">Preprocessing</h2>
<p>Preprocessing consists of <em>optional</em> steps that gather information to be later used in building the site. Most preprocessing can be done once and never again, if you are careful. Anyway, if you need to run them, do make a full build to update everything.</p>
<h3 id="listing-the-categories">Listing the categories</h3>
<p>As you’ve been told, <em>categories</em> refer to the textual genre of the post. Therefore, you won’t have too many. My own blog does only have the following: “short stories”, “reviews”, “articles”, “flash fiction”, “essays”, “incomplete”, “fragments”, “novellas”, “novels”, “updates”, “opinion”, “musings”, “translations”, “tutorials”, “poetry” and “criticism”.</p>
<p>This script reads all blog posts in <code>src/posts/</code> and feeds them into Pandoc, which pipes them to <code>jq</code>, which lists categories into a file called <code>catlist.txt</code> in the build root. This file is renewed every time the script is run.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> taglist.txt</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> post <span class="kw">in</span> <span class="kw">`</span><span class="fu">find</span> src/posts <span class="at">-type</span> f <span class="at">-iname</span> <span class="dt">\*</span>.md<span class="kw">`</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--template</span><span class="op">=</span>templates/metadata.tpl  <span class="va">$post</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> <span class="st">&#39;.categories|tsv&#39;</span> <span class="op">&gt;&gt;</span> taglist.txt</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tr</span> <span class="st">&#39;\t&#39;</span> <span class="st">&quot;\n&quot;</span> <span class="op">&lt;</span> catlist.txt <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="op">&gt;</span> _catlist</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> _catlist catlist.txt</span></code></pre></div>
<p>In theory, you only need to run this script exactly <em>once</em>, when you setup the blog, and even then, only if you have a large number of posts imported from a WordPress installation. If you are manually adding posts to your blog, <em>after</em> you have compiled it, or if you are writing your blog from scratch, it’s probably better to just curate yourself a list of categories named <code>catlist.txt</code> in the build root folder. Just put each category in a line of its own, using underscores to link words, thus avoiding spaces in filenames. And remember not to delete it by accident.</p>
<h3 id="listing-the-tags">Listing the tags</h3>
<p>As you’ve been told, <em>tags</em> refer to the subject matter of the post. Therefore, you can have as many as you need or wish. My blog used to have about 300 of them, thanks to the <em>useful</em> contribution of my readers, who couldn’t resist tagging my posts when I enabled the “comments can add tags” WordPress plugin. However, having too many tags defeats the purpose of having tags anyway <em>and will slow your blog</em>.</p>
<p>The script is identical to <code>get_cats.sh</code> (but for replacing tags for categories where needed). It reads all posts in <code>src/posts/</code> and feeds them into Pandoc, which then pipes them to <code>jq</code>, which lists the tags into a file called <code>taglist.txt</code> in the build root. This file is renewed every time the script is run.<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> taglist.txt</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> post <span class="kw">in</span> <span class="kw">`</span><span class="fu">find</span> src/posts <span class="at">-type</span> f <span class="at">-name</span> <span class="dt">\*</span>.md<span class="kw">`</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--template</span> templates/metadata.tpl  <span class="va">$post</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="at">-r</span> <span class="st">&#39;.tags|tsv&#39;</span> <span class="op">&gt;&gt;</span> taglist.txt</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tr</span> <span class="st">&#39;\t&#39;</span> <span class="st">&quot;\n&quot;</span> <span class="op">&lt;</span> taglist.txt <span class="kw">|</span> <span class="fu">sort</span> <span class="kw">|</span> <span class="fu">uniq</span> <span class="op">&gt;</span> _taglist</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> _taglist taglist.txt</span></code></pre></div>
<p>In theory, you only need to run this script exactly <em>once</em>, when you setup the blog, if you have a large number of posts imported from a WordPress installation. If you are adding posts to your blog, <em>after</em> you have compiled it, or if you are writing your blog from scratch, it’s probably better to just curate yourself a list of tags named <code>taglist.txt</code> in the build root folder. Just put each tag in a line of its own, using underscores to link words, thus avoiding spaces in filenames.</p>
<h3 id="finding-the-recent-posts">Finding the recent posts</h3>
<p>Every time you add a new entry to your blog you must make it appear in the landing page, so your visitors know about it. This script does just that, it lists the six most recent files you created there, greps them for content and formats the information in HTML, redirecting that into a file named <code>recent.txt</code> in the build root.</p>
<p>At this point the scripts will identify the most recent post in your source tree and store its date in a variable which will be added to your “sidebar”, advertising to the world when you last posted something.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> recent.txt </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> recent <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> src/posts <span class="at">-type</span> f <span class="at">-iname</span> <span class="dt">\*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-ur</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 6<span class="va">)</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="va">entry</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$recent</span> .md<span class="va">)</span><span class="st">.html&quot;</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;title: &quot;</span> <span class="va">$recent</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="va">plink</span><span class="op">=</span><span class="st">&quot;posts/</span><span class="va">$entry</span><span class="st">&quot;</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="va">teaser</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$recent</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;1,/^$/d&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;/^$/,$d&#39;</span> <span class="kw">|</span> <span class="ex">pandoc</span> <span class="va">)</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="va">cover</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;coverImage:&quot;</span> <span class="va">$recent</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="va">date</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;date: &quot;</span> <span class="va">$recent</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39; &#39;</span> <span class="at">-f2</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$date</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$cover</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="cf">then</span> </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="va">coverpic</span><span class="op">=</span><span class="st">&quot;&lt;figure class=</span><span class="dt">\&quot;</span><span class="st">thumb</span><span class="dt">\&quot;</span><span class="st">&gt;&lt;img src=</span><span class="dt">\&quot;</span><span class="st">/images/</span><span class="va">$cover</span><span class="dt">\&quot;</span><span class="st"> alt=</span><span class="dt">\&quot;</span><span class="st">post thumbnail</span><span class="dt">\&quot;</span><span class="st"> /&gt;&lt;/figure&gt;&quot;</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="va">coverpic</span><span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;div class=&quot;</span>recent-posts<span class="st">&quot;&gt;</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="st">## [</span><span class="va">$title</span><span class="st">](</span><span class="va">$plink</span><span class="st">)</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="va">$coverpic</span><span class="st"> </span><span class="va">$teaser</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/div&gt;</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> recent.txt</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<p>This is <em>all</em> that this script does. It doesn’t really compile anything, it just prepares a list of recent posts that will be later used to compile the landing page.</p>
<h3 id="setting-up-the-pinned-post">Setting up the pinned post</h3>
<p>Pinned content is what you want to have in your landing page, regardless of its recency. Content you don’t want to replace with your newer content. You could write this content into the <code>index.md</code> file, but that could be too cumbersome if your pinned content is long and complex. Here comes the <code>set_pinned.sh</code> script to rescue:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="va">pintitle</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;title: &quot;</span> pinned.md <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="va">pinlink</span><span class="op">=</span><span class="va">$(</span><span class="fu">readlink</span> pinned.md <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/.md/.html/g&#39;</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f2,3</span><span class="va">)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="va">pintease</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> pinned.md <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;1,/^$/d&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;/^$/,$d&#39;</span><span class="va">)</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;div id=</span><span class="dt">\&quot;</span><span class="st">pinned</span><span class="dt">\&quot;</span><span class="st">&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="st">## [</span><span class="va">$pintitle</span><span class="st">](</span><span class="va">$pinlink</span><span class="st">)</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;div class=</span><span class="dt">\&quot;</span><span class="st">info-icon</span><span class="dt">\&quot;</span><span class="st">&gt;&lt;i class=</span><span class="dt">\&quot;</span><span class="st">fas fa-info-circle</span><span class="dt">\&quot;</span><span class="st">&gt;&lt;/i&gt;&lt;/div&gt;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="va">$pintease</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/div&gt;</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> pinned.txt</span></code></pre></div>
<p>This script does for the pinned post, which you have manually symlinked to <code>pinned.md</code>, the same that <code>set_recent.sh</code> does for recent posts, but it doesn’t need a cover image, as it uses a FontAwesome-provided warning icon.</p>
<p>You will notice that it outputs to <code>pinned.txt</code>. There are two files named “pinned” in the build root, one is a symlink to a Markdown file you have written, the other is a text file created by this script. If you link your pinned content to <code>pinned.txt</code> instead of <code>pinned.md</code> something nasty will happen: you will destroy the contents of the file containing your pinned post. <strong>So, don’t do that!</strong></p>
<h2 id="compilation">Compilation</h2>
<p>Because all scripts process the Markdown source files in the source tree and write to the output folders in the build root, they don’t depend on the HTML output for anything. The “do” scripts can also be used in any order as well.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
<h3 id="building-the-landing-page">Building the landing page</h3>
<p>Once you have written your greetings, set a pinned post and have written at least six posts, you can compile your landing page:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span> src/index.md pinned.txt recent.txt <span class="dt">\</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span> index.html <span class="at">--standalone</span> <span class="dt">\</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="dt">\</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  catprefix=<span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   catcount=<span class="st">&quot;</span><span class="va">$catcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  postcount=<span class="st">&quot;</span><span class="va">$postcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  tagprefix=<span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   tagcount=<span class="st">&quot;</span><span class="va">$tagcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    archive=<span class="st">&quot;</span><span class="va">$archive</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    fonturl=<span class="st">&quot;</span><span class="va">$fonturl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenctxt=<span class="st">&quot;</span><span class="va">$fontenctxt</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenchdr=<span class="st">&quot;</span><span class="va">$fontenchdr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>       lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Homepage compiled ...&quot;</span></span></code></pre></div>
<p>This is the first time Pandoc is actually evoked to process Markdown files. Everything here is fed up from the <code>site_vars.sh</code> file (which you have surely edited to your liking) and based on the HTML5 template (here called <code>blog.htm</code>, but you can name it anything you want), the sidebar and the footer. Just change the language tag from (“pt”) if you don’t write in Portuguese. There’s nothing else special here.</p>
<p>This is also the same basic Pandoc evocation that will be used again and again in the next steps, only changing the inputs and outputs.</p>
<p>You can see, in the end, that Pandoc concatenates the three input files (<code>index.md</code>, <code>pinned.txt</code> and <code>recent.txt</code>) before processing them, and writes the output to <code>index.html</code> in the build root.</p>
<h3 id="category-pages-and-category-index">Category pages and category index</h3>
<p>This script reads all blog posts in <code>src/posts/</code> and greps them for the categories listed in the <code>catlist.txt</code> file in the build root. The filenames are written to a list that will be input in a later stage. In the end, the script builds a page for every category listing posts belonging to it, and then an index page listing all categories.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="va">$catprefix</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="va">catprefix</span><span class="op">=</span><span class="st">&quot;categories&quot;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="va">$tagprefix</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="va">tagprefix</span><span class="op">=</span><span class="st">&quot;tags&quot;</span> </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Will create and populate category pages.&quot;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> category <span class="kw">in</span> <span class="kw">`</span><span class="fu">cat</span> catlist.txt<span class="kw">`</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="va">ind</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">/</span><span class="va">$category</span><span class="st">/index.txt&quot;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="va">tmp</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">/</span><span class="va">$category</span><span class="st">/_posts.txt&quot;</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$catprefix</span>/<span class="va">$category</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$catprefix</span>/<span class="va">$category</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="st">title: Artigos da categoria </span><span class="dt">\&quot;</span><span class="va">$category</span><span class="dt">\&quot;</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;div class=</span><span class="dt">\&quot;</span><span class="st">postlist</span><span class="dt">\&quot;</span><span class="st">&gt;</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> <span class="va">$ind</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Grepping each post by category.&quot;</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-le</span> <span class="st">&quot;  - </span><span class="dt">\&quot;</span><span class="va">$category</span><span class="dt">\&quot;</span><span class="st">&quot;</span> src/posts/<span class="pp">*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span> <span class="op">&gt;</span> <span class="va">$tmp</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Listing posts in categories.&quot;</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> blogpost <span class="kw">in</span> <span class="kw">`</span><span class="fu">cat</span> <span class="va">$tmp</span><span class="kw">`</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    <span class="va">fdate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f1,2,3</span><span class="va">)</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    <span class="va">plink</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span>.html<span class="va">)</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-e</span> <span class="st">&quot;title: </span><span class="dt">\&quot;</span><span class="st">&quot;</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    <span class="va">pyear</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%Y&#39;</span><span class="va">)</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;- &lt;span class=</span><span class="dt">\&quot;</span><span class="st">pdate</span><span class="dt">\&quot;</span><span class="st">&gt;</span><span class="va">$pdate</span><span class="st">&lt;/span&gt; - [</span><span class="va">$title</span><span class="st">](/posts/</span><span class="va">$plink</span><span class="st">)&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$ind</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Encontrado </span><span class="dt">\&quot;</span><span class="va">$title</span><span class="dt">\&quot;</span><span class="st">, de </span><span class="va">$pdate</span><span class="st">, categoria </span><span class="dt">\&quot;</span><span class="va">$category</span><span class="dt">\&quot;</span><span class="st">.&quot;</span>  </span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;/div&gt;&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$ind</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Compiling category index pages&quot;</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>  <span class="va">$ind</span>   <span class="dt">\</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span> <span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">/</span><span class="va">$category</span><span class="st">/</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$ind</span> .txt<span class="va">)</span><span class="st">.html&quot;</span> <span class="dt">\</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="dt">\</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  catprefix=<span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   catcount=<span class="st">&quot;</span><span class="va">$catcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  tagprefix=<span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   tagcount=<span class="st">&quot;</span><span class="va">$tagcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  postcount=<span class="st">&quot;</span><span class="va">$postcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    archive=<span class="st">&quot;</span><span class="va">$archive</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    fonturl=<span class="st">&quot;</span><span class="va">$fonturl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenctxt=<span class="st">&quot;</span><span class="va">$fontenctxt</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenchdr=<span class="st">&quot;</span><span class="va">$fontenchdr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>       lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a><span class="st">title: </span><span class="dt">\&quot;</span><span class="st">Lista de categorias</span><span class="dt">\&quot;</span></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="st">Categorias procuram classificar o conteúdo quanto ao gênero</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="st">textual e à intenção da escrita. As categorias do </span><span class="dt">\&quot;</span><span class="st">Letras Elétricas</span><span class="dt">\&quot;</span></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="st">são herdadas do antigo blog em WordPress e serão gradualmente </span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a><span class="st">alteradas, à medida que os posts forem editados.</span></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a><span class="st">|:---:|:---:|:---:|&quot;</span> <span class="op">&gt;</span> <span class="va">$catprefix</span>/index.txt</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> catlist.txt <span class="va">$catprefix</span>/_catlist.txt </span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="at">-d</span><span class="st">&#39; &#39;</span> catlist.txt <span class="va">$catprefix</span>/_catlist.txt <span class="op">&gt;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span>  <span class="st">&#39;s/ $//g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a><span class="fu">tr</span> <span class="at">-s</span> <span class="st">&quot; &quot;</span> <span class="op">&lt;</span> <span class="va">$catprefix</span>/_index.txt <span class="op">&gt;</span> <span class="va">$catprefix</span>/__index.txt</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$catprefix</span>/__index.txt <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/$/ |/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="va">$catprefix</span>/_index.txt <span class="kw">|</span> <span class="fu">tr</span> <span class="dt">\ </span> <span class="dt">\\</span>n <span class="kw">|</span> <span class="ex">column</span> <span class="at">-x</span> <span class="at">-c</span> 150 <span class="op">&gt;</span> <span class="va">$catprefix</span>/__index.txt</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$catprefix</span>/__index.txt <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/\t/ /g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/  / /g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/^/| /g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/ |/\/index.html) |/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/| /| [/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/ /] /g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/|]/|/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/] /](/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/](|/ |/g&#39;</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="va">$catprefix</span>/_index.txt <span class="op">&gt;&gt;</span> <span class="va">$catprefix</span>/index.txt</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$catprefix</span>/_index.txt</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a><span class="st">|:----:|:----:|</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a><span class="st">| [Retornar aos posts](/posts/index.html) | [Retornar à home](/index.html) |</span></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;&gt;</span> <span class="va">$catprefix</span>/index.txt</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>  <span class="va">$catprefix</span>/index.txt   <span class="dt">\</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">-o</span> <span class="va">$catprefix</span>/index.html <span class="dt">\</span></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="dt">\</span></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  catprefix=<span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   catcount=<span class="st">&quot;</span><span class="va">$catcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  tagprefix=<span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   tagcount=<span class="st">&quot;</span><span class="va">$tagcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  postcount=<span class="st">&quot;</span><span class="va">$postcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    archive=<span class="st">&quot;</span><span class="va">$archive</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    fonturl=<span class="st">&quot;</span><span class="va">$fonturl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenctxt=<span class="st">&quot;</span><span class="va">$fontenctxt</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenchdr=<span class="st">&quot;</span><span class="va">$fontenchdr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>       lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-z</span> <span class="st">&#39;s/&lt;table&gt;/&lt;table class=\&quot;back\&quot;&gt;/2&#39;</span> <span class="va">$catprefix</span>/index.html <span class="op">&gt;</span> posts.htm</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> posts.htm <span class="va">$catprefix</span>/index.html</span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Categories index prepared&quot;</span></span></code></pre></div>
<p>As you can see, we generate one <code>index.html</code> page for every category, and then an <code>index.html</code> for the categories folder itself, containing a table with all categories in it.</p>
<h3 id="compiling-tag-pages-and-tag-index">Compiling tag pages and tag index</h3>
<p>The <code>do_tags.sh</code> script does more or less the same as the <code>do_cats.sh</code> script, except that it works with the “tags” taxonomy. A few bits here and there are tweaked, but the script is basically the same. Besides changing <code>$catprefix</code> for <code>$tagprefix</code> in every line, you must adjust the column width from <code>column -x -c 150</code> to <code>column -x -c 230</code> because tags tend to have longer names than categories and the table will not work then (you don’t need to do that, though, if the script works for you).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Will build index pages for the tags&quot;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tag <span class="kw">in</span> <span class="kw">`</span><span class="fu">cat</span> taglist.txt<span class="kw">`</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="va">ind</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">/</span><span class="va">$tag</span><span class="st">/index.txt&quot;</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="va">tmp</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">/</span><span class="va">$tag</span><span class="st">/_posts.txt&quot;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$tagprefix</span>/<span class="va">$tag</span>/<span class="pp">*</span>.txt</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$tagprefix</span>/<span class="va">$tag</span>/</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="st">title: Postagens sobre </span><span class="dt">\&quot;</span><span class="va">$tag</span><span class="dt">\&quot;</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;div class=</span><span class="dt">\&quot;</span><span class="st">postlist</span><span class="dt">\&quot;</span><span class="st">&gt;</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> <span class="va">$ind</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Grepping posts for tags,</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="st">This may take a long time.&quot;</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-le</span> <span class="st">&quot;  - </span><span class="dt">\&quot;</span><span class="va">$tag</span><span class="dt">\&quot;</span><span class="st">&quot;</span> src/posts/<span class="pp">*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span> <span class="op">&gt;</span> <span class="va">$tmp</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Populating tag index pages.&quot;</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> blogpost <span class="kw">in</span> <span class="kw">`</span><span class="fu">cat</span> <span class="va">$tmp</span><span class="kw">`</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="va">fdate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f1,2,3</span><span class="va">)</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="va">plink</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span>.html<span class="va">)</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-e</span> <span class="st">&quot;title: </span><span class="dt">\&quot;</span><span class="st">&quot;</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="va">pyear</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%Y&#39;</span><span class="va">)</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;- &lt;span class=</span><span class="dt">\&quot;</span><span class="st">pdate</span><span class="dt">\&quot;</span><span class="st">&gt;</span><span class="va">$pdate</span><span class="st">&lt;/span&gt; - </span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="st">[</span><span class="va">$title</span><span class="st">](/posts/</span><span class="va">$plink</span><span class="st">)&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$ind</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="st">    Encontrado post </span><span class="dt">\&quot;</span><span class="va">$title</span><span class="dt">\&quot;</span><span class="st">, de </span><span class="va">$pdate</span><span class="st">, </span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="st">    marcado no assunto </span><span class="dt">\&quot;</span><span class="va">$tag</span><span class="dt">\&quot;</span><span class="st">. </span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;</span>  </span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;/div&gt;&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$ind</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Compiling tag index page.&quot;</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>  <span class="va">$ind</span>   <span class="dt">\</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span> <span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">/</span><span class="va">$tag</span><span class="st">/</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$ind</span> .txt<span class="va">)</span><span class="st">.html&quot;</span> <span class="dt">\</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="dt">\</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  catprefix=<span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   catcount=<span class="st">&quot;</span><span class="va">$catcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  tagprefix=<span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   tagcount=<span class="st">&quot;</span><span class="va">$tagcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  postcount=<span class="st">&quot;</span><span class="va">$postcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    archive=<span class="st">&quot;</span><span class="va">$archive</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    fonturl=<span class="st">&quot;</span><span class="va">$fonturl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenctxt=<span class="st">&quot;</span><span class="va">$fontenctxt</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenchdr=<span class="st">&quot;</span><span class="va">$fontenchdr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>       lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Finished populating tags,</span></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a><span class="st">Will now create the tags index.&quot;</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a><span class="st">title: </span><span class="dt">\&quot;</span><span class="st">Lista de assuntos</span><span class="dt">\&quot;</span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a><span class="st">Assuntos (_tags_) classificam as postagens pelo conteúdo e pelo</span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a><span class="st">estilo, em vez do gênero textual. Na maioria dos blogs, as </span></span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a><span class="st">_tags_ são usadas somente para classificar os artigos a fim de</span></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a><span class="st">gerar sugestões de páginas afins.</span></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a><span class="st">As _tags_ aqui indicadas são as que haviam sido geradas pelo</span></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a><span class="st">antigo site em WordPress. Infelizmente, muitas destas</span></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a><span class="st">estão repetidas devido a pequenos erros de digitação. Esta </span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a><span class="st">situação foi causada pela interface imperfeita do WordPress para</span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a><span class="st">manipular categorias e tags, que muito dificultava a consulta </span></span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a><span class="st">das existentes.</span></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a><span class="st">Além disso, por um certo tempo eu mantive instalado no meu blog</span></span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a><span class="st">o plug-in </span><span class="dt">\&quot;</span><span class="st">Commenters Can Add Tags</span><span class="dt">\&quot;</span><span class="st">, que foi abusado pelos</span></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a><span class="st">visitantes para criar muitas _tags_ absurdas ou até obscenas.</span></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a><span class="st">Com alguma dificuldade eu consegui remover a maioria destas</span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a><span class="st">antes de fazer o _upload_ da nova versão.</span></span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a><span class="st">|:---:|:---:|:---:|&quot;</span> <span class="op">&gt;</span> <span class="va">$tagprefix</span>/index.txt</span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> taglist.txt <span class="va">$tagprefix</span>/_taglist.txt </span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> <span class="at">-d</span><span class="st">&#39; &#39;</span> taglist.txt <span class="va">$tagprefix</span>/_taglist.txt <span class="op">&gt;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span>  <span class="st">&#39;s/ $//g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a><span class="fu">tr</span> <span class="at">-s</span> <span class="st">&quot; &quot;</span> <span class="op">&lt;</span> <span class="va">$tagprefix</span>/_index.txt <span class="op">&gt;</span> <span class="va">$tagprefix</span>/__index.txt</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$tagprefix</span>/__index.txt <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/$/ |/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="va">$tagprefix</span>/_index.txt <span class="kw">|</span> <span class="fu">tr</span> <span class="dt">\ </span> <span class="dt">\\</span>n <span class="kw">|</span> <span class="ex">column</span> <span class="at">-x</span> <span class="at">-c</span> 230 <span class="op">&gt;</span> <span class="va">$tagprefix</span>/__index.txt</span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$tagprefix</span>/__index.txt <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a><span class="fu">tr</span> <span class="at">-s</span> <span class="st">&quot;\t&quot;</span> <span class="op">&lt;</span> <span class="va">$tagprefix</span>/_index.txt <span class="op">&gt;</span> <span class="va">$tagprefix</span>/__index.txt </span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">$tagprefix</span>/__index.txt <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/\t/ /g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/  / /g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/^/| /g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/ |/\/index.html) |/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/| /| [/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/ /] /g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/|]/|/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/] /](/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/](|/ |/g&#39;</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="va">$tagprefix</span>/_index.txt <span class="op">&gt;&gt;</span> <span class="va">$tagprefix</span>/index.txt</span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$tagprefix</span>/_index.txt</span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span></span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a><span class="st">|:----:|:----:|</span></span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a><span class="st">| [Retornar aos posts](/posts/index.html) | [Retornar à home](/index.html) |</span></span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span><span class="op">&gt;&gt;</span> <span class="va">$tagprefix</span>/index.txt</span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Tag index prepared.</span></span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a><span class="st">Will compile the tag index page...&quot;</span></span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>  <span class="va">$tagprefix</span>/index.txt   <span class="dt">\</span></span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span> <span class="va">$tagprefix</span>/index.html <span class="dt">\</span></span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="dt">\</span></span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  catprefix=<span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   catcount=<span class="st">&quot;</span><span class="va">$catcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  tagprefix=<span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   tagcount=<span class="st">&quot;</span><span class="va">$tagcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  postcount=<span class="st">&quot;</span><span class="va">$postcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    archive=<span class="st">&quot;</span><span class="va">$archive</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    fonturl=<span class="st">&quot;</span><span class="va">$fonturl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenctxt=<span class="st">&quot;</span><span class="va">$fontenctxt</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenchdr=<span class="st">&quot;</span><span class="va">$fontenchdr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>       lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-z</span> <span class="st">&#39;s/&lt;table&gt;/&lt;table class=\&quot;back\&quot;&gt;/2&#39;</span> <span class="va">$tagprefix</span>/index.html <span class="op">&gt;</span> posts.htm</span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> posts.htm <span class="va">$tagprefix</span>/index.html</span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Tag index compiled.&quot;</span></span></code></pre></div>
<p>You can ajust column width in both scripts, to ensure the tables are generated without problems. The desired layout is a table of three-columns.</p>
<h3 id="fixed-pages-1">Fixed pages</h3>
<p>Fixed pages are very easy to process, as they have no tags. It’s just a case of getting a list of their filenames, processing all of them and outputing to the <code>/pages/</code> directory.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> page <span class="kw">in</span> <span class="kw">`</span><span class="fu">find</span> src/pages <span class="at">-type</span> f <span class="at">-iname</span> <span class="dt">\*</span>.md<span class="kw">`</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>       <span class="va">$page</span>  <span class="dt">\</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span>     pages/<span class="st">&quot;</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$page</span> .md<span class="va">)</span><span class="st">.html&quot;</span> <span class="dt">\</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="dt">\</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  catprefix=<span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   catcount=<span class="st">&quot;</span><span class="va">$catcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  tagprefix=<span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   tagcount=<span class="st">&quot;</span><span class="va">$tagcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  postcount=<span class="st">&quot;</span><span class="va">$postcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    archive=<span class="st">&quot;</span><span class="va">$archive</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    fonturl=<span class="st">&quot;</span><span class="va">$fonturl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenctxt=<span class="st">&quot;</span><span class="va">$fontenctxt</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenchdr=<span class="st">&quot;</span><span class="va">$fontenchdr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>       lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Static pages compiled successfully&quot;</span></span></code></pre></div>
<h3 id="blog-posts-1">Blog posts</h3>
<p>This is a quite time-consuming stage of the compilation. So much so that I have included a script to compile single posts without the full wait of a complete blog update). My own blog takes 144 seconds to compile all posts (they being so many).</p>
<p>The script itself isn’t much complicated, though:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> src/posts/ <span class="at">-name</span> <span class="dt">\*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="op">&gt;</span> manifest.txt</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> blogpost <span class="kw">in</span> <span class="kw">`</span><span class="fu">find</span> src/posts <span class="at">-name</span> <span class="dt">\*</span>.md <span class="kw">|</span> <span class="fu">sort</span><span class="kw">`;</span> <span class="cf">do</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">fdate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f1,2,3</span><span class="va">)</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="va">slug</span><span class="op">=</span><span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="va">befo</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-B</span> 1 <span class="va">$blogpost</span> manifest.txt <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;2d&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/src//&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/md/html/&#39;</span><span class="va">)</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="va">aftr</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-A</span> 1 <span class="va">$blogpost</span> manifest.txt <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;1d&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/src//&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/md/html/&#39;</span><span class="va">)</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Compiling </span><span class="va">$slug</span><span class="st">&quot;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>  <span class="va">$blogpost</span> <span class="dt">\</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span>     posts/<span class="va">$slug</span><span class="st">&quot;.html&quot;</span> <span class="at">--toc</span> <span class="at">--toc-depth</span><span class="op">=</span>2 <span class="dt">\</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="dt">\</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>      befo=<span class="st">&quot;</span><span class="va">$befo</span><span class="st">&quot;</span> <span class="at">-V</span> aftr=<span class="st">&quot;</span><span class="va">$aftr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  published=<span class="st">&quot;</span><span class="va">$pdate</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  catprefix=<span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   catcount=<span class="st">&quot;</span><span class="va">$catcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  tagprefix=<span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   tagcount=<span class="st">&quot;</span><span class="va">$tagcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  postcount=<span class="st">&quot;</span><span class="va">$postcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    archive=<span class="st">&quot;</span><span class="va">$archive</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    fonturl=<span class="st">&quot;</span><span class="va">$fonturl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenctxt=<span class="st">&quot;</span><span class="va">$fontenctxt</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenchdr=<span class="st">&quot;</span><span class="va">$fontenchdr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>       lang=<span class="st">&quot;pt&quot;</span>  <span class="kw">&amp;</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pid <span class="kw">in</span> <span class="va">$(</span><span class="bu">jobs</span> <span class="at">-p</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">wait</span> <span class="va">$pid</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Finished compilation of all post pages.&quot;</span></span></code></pre></div>
<p>Compiling single posts is done by the <code>update_post.sh</code> script:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="va">blogpost</span><span class="op">=</span><span class="va">$1</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="va">befo</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-B</span> 1 <span class="va">$blogpost</span> manifest.txt <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;2d&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/src//&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/md/html/&#39;</span><span class="va">)</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="va">aftr</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-A</span> 1 <span class="va">$blogpost</span> manifest.txt <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;1d&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/src//&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/md/html/&#39;</span><span class="va">)</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="va">fdate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f1,2,3</span><span class="va">)</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="va">slug</span><span class="op">=</span>posts/<span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="va">plink</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span>.html<span class="va">)</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-e</span> <span class="st">&quot;title: </span><span class="dt">\&quot;</span><span class="st">&quot;</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="va">pyear</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%Y&#39;</span><span class="va">)</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>  <span class="va">$blogpost</span> <span class="dt">\</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">-o</span>     <span class="va">$slug</span><span class="st">&quot;.html&quot;</span> <span class="at">--toc</span> <span class="at">--toc-depth</span><span class="op">=</span>3 <span class="dt">\</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="dt">\</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>      befo=<span class="st">&quot;</span><span class="va">$befo</span><span class="st">&quot;</span> <span class="at">-V</span> aftr=<span class="st">&quot;</span><span class="va">$aftr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  published=<span class="st">&quot;</span><span class="va">$pdate</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  catprefix=<span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   catcount=<span class="st">&quot;</span><span class="va">$catcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  tagprefix=<span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   tagcount=<span class="st">&quot;</span><span class="va">$tagcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  postcount=<span class="st">&quot;</span><span class="va">$postcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    archive=<span class="st">&quot;</span><span class="va">$archive</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    fonturl=<span class="st">&quot;</span><span class="va">$fonturl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenctxt=<span class="st">&quot;</span><span class="va">$fontenctxt</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenchdr=<span class="st">&quot;</span><span class="va">$fontenchdr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>       lang=<span class="st">&quot;pt&quot;</span></span></code></pre></div>
<p>In the current state of things, my posts index page features the same layout as the posts archive (which are explained next), but with a bit of extras above and below.</p>
<h3 id="archive-of-posts-by-year">Archive of posts by year</h3>
<p>This is one of the coolest things I have been able to create for my blog, using only shell script. That is also one Jilles didn’t do; probably because he didn’t need or want to, as he didn’t use categories and tags either. The archive thingy demanded a lot of tweaks before it barely works and you will probably have to edit the script many times over, before it works for you (and there’s some CSS you’ll need, too), but it is already <em>awesome!</em></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="st">title: </span><span class="dt">\&quot;</span><span class="st">Página de índices</span><span class="dt">\&quot;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="st">|:--------------:|:-------------:|:---------------------:|</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="st">| [artigos por categoria](/</span><span class="va">$catprefix</span><span class="st">/index.html) | </span><span class="dt">\</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="st">[artigos por assunto](/</span><span class="va">$tagprefix</span><span class="st">/index.html) | [lista completa](</span><span class="va">$archive</span><span class="st">.html) |</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> posts/index.txt</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> blogpost <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> src/posts <span class="at">-type</span> f <span class="at">-iname</span> <span class="st">&quot;*.md&quot;</span> <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 10<span class="va">)</span><span class="kw">;</span> </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="va">fdate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f1,2,3</span><span class="va">)</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="va">pyear</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%Y&#39;</span><span class="va">)</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%d/%m/%Y&#39;</span><span class="va">)</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="va">plink</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span>.html<span class="va">)</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-e</span> <span class="st">&quot;title: &quot;</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;:&#39;</span> <span class="at">-f2,3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;- &lt;b class=</span><span class="dt">\&quot;</span><span class="st">pdate</span><span class="dt">\&quot;</span><span class="st">&gt;</span><span class="va">$pdate</span><span class="st">&lt;/b&gt; - [</span><span class="va">$title</span><span class="st">](/posts/</span><span class="va">$plink</span><span class="st">)&quot;</span> <span class="op">&gt;&gt;</span> posts/index.txt</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$archive</span>/<span class="pp">*</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> Year <span class="kw">in</span> <span class="kw">`</span><span class="fu">cat</span> years.txt<span class="kw">`;</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="va">ind</span><span class="op">=</span><span class="va">$archive</span>/<span class="va">$Year</span>/index.txt</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="va">tmp</span><span class="op">=</span><span class="va">$archive</span>/<span class="va">$Year</span>/posts.txt</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$ind</span> <span class="va">$tmp</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$archive</span>/<span class="va">$Year</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$archive</span>/<span class="va">$Year</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="st">title: Artigos publicados em </span><span class="va">$Year</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> <span class="va">$ind</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> blogpost <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> src/posts/ <span class="at">-type</span> f <span class="at">-iname</span> <span class="va">$Year</span>-<span class="dt">\*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span><span class="va">)</span><span class="kw">;</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>    <span class="va">fdate</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f1,2,3</span><span class="va">)</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>    <span class="va">plink</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$(</span><span class="fu">basename</span> <span class="va">$blogpost</span> .md<span class="va">)</span>.html<span class="va">)</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>    <span class="va">pdate</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%d/%m&#39;</span><span class="va">)</span></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>    <span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="at">-e</span> <span class="st">&quot;title: </span><span class="dt">\&quot;</span><span class="st">&quot;</span> <span class="va">$blogpost</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>    <span class="va">pyear</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> <span class="at">--date</span><span class="op">=</span><span class="va">$fdate</span> <span class="st">&#39;+%Y&#39;</span><span class="va">)</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;- &lt;b class=</span><span class="dt">\&quot;</span><span class="st">pdate</span><span class="dt">\&quot;</span><span class="st">&gt;</span><span class="va">$pdate</span><span class="st">&lt;b&gt; - [</span><span class="va">$title</span><span class="st">](/posts/</span><span class="va">$plink</span><span class="st">)&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$ind</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;Encontrado </span><span class="dt">\&quot;</span><span class="va">$title</span><span class="dt">\&quot;</span><span class="st">, de </span><span class="va">$pyear</span><span class="st">.&quot;</span>  </span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>       <span class="va">$ind</span>  <span class="dt">\</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span>     <span class="va">$archive</span>/<span class="va">$Year</span>/index.html   <span class="dt">\</span></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="dt">\</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  catprefix=<span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   catcount=<span class="st">&quot;</span><span class="va">$catcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  tagprefix=<span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   tagcount=<span class="st">&quot;</span><span class="va">$tagcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  postcount=<span class="st">&quot;</span><span class="va">$postcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    archive=<span class="st">&quot;</span><span class="va">$archive</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    fonturl=<span class="st">&quot;</span><span class="va">$fonturl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenctxt=<span class="st">&quot;</span><span class="va">$fontenctxt</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenchdr=<span class="st">&quot;</span><span class="va">$fontenchdr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>       lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;---</span></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a><span class="st">title: </span><span class="dt">\&quot;</span><span class="st">Arquivo do blog</span><span class="dt">\&quot;</span></span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$archive</span>/index.txt</span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span></span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a><span class="st">|</span></span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a><span class="st">|:----:|:----:|:----:|&quot;</span> <span class="op">&gt;</span> tab.txt</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> years.txt <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&quot;s/^/(\/</span><span class="va">${archive}</span><span class="st">\//g&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/$/\/index.html)/g&#39;</span> <span class="op">&gt;</span> ylinks.txt</span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> years.txt <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-r</span> <span class="op">&gt;</span> xyears.txt</span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a><span class="ex">paste</span> xyears.txt ylinks.txt <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/^/[/g&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/\t/]/g&#39;</span> <span class="op">&gt;</span> yyears.txt</span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> yyears.txt <span class="kw">|</span> <span class="ex">column</span> <span class="at">-x</span> <span class="at">-c</span> 120 <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/^/| /g&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/$/ |/g&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/\t/ | /g&#39;</span> <span class="op">&gt;&gt;</span> tab.txt</span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> tab.txt <span class="op">&gt;&gt;</span> <span class="va">$archive</span>/index.txt</span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> ylinks.txt yyears.txt</span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>       <span class="va">$archive</span>/index.txt  <span class="dt">\</span></span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span>     <span class="va">$archive</span>/index.html   <span class="dt">\</span></span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="dt">\</span></span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  catprefix=<span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   catcount=<span class="st">&quot;</span><span class="va">$catcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  tagprefix=<span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   tagcount=<span class="st">&quot;</span><span class="va">$tagcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  postcount=<span class="st">&quot;</span><span class="va">$postcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    archive=<span class="st">&quot;</span><span class="va">$archive</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    fonturl=<span class="st">&quot;</span><span class="va">$fonturl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-113"><a href="#cb22-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-114"><a href="#cb22-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenctxt=<span class="st">&quot;</span><span class="va">$fontenctxt</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-116"><a href="#cb22-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenchdr=<span class="st">&quot;</span><span class="va">$fontenchdr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>       lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-120"><a href="#cb22-120" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/&lt;table&gt;/&lt;table class=&quot;years&quot;&gt;/g&#39;</span> <span class="va">$archive</span>/index.html</span>
<span id="cb22-121"><a href="#cb22-121" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb22-122"><a href="#cb22-122" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> tab.txt <span class="op">&gt;&gt;</span> posts/index.txt</span>
<span id="cb22-123"><a href="#cb22-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-124"><a href="#cb22-124" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">--to</span><span class="op">=</span>html5 <span class="at">--from</span> <span class="va">$panopts</span>       posts/index.txt  <span class="dt">\</span></span>
<span id="cb22-125"><a href="#cb22-125" aria-hidden="true" tabindex="-1"></a>       <span class="at">-o</span>     posts/index.html   <span class="dt">\</span></span>
<span id="cb22-126"><a href="#cb22-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">--title-prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$site_id</span><span class="st"> · &quot;</span> <span class="dt">\</span></span>
<span id="cb22-127"><a href="#cb22-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">--template</span> templates/blog.html <span class="dt">\</span></span>
<span id="cb22-128"><a href="#cb22-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    site_id=<span class="st">&quot;</span><span class="va">$site_id</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-129"><a href="#cb22-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  site_desc=<span class="st">&quot;</span><span class="va">$site_desc</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-130"><a href="#cb22-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     author=<span class="st">&quot;</span><span class="va">$author</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-131"><a href="#cb22-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  signature=<span class="st">&quot;</span><span class="va">$signature</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-132"><a href="#cb22-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     updmsg=<span class="st">&quot;</span><span class="va">$updmsg</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-133"><a href="#cb22-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>     update=<span class="st">&quot;</span><span class="va">$update</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-134"><a href="#cb22-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  catprefix=<span class="st">&quot;</span><span class="va">$catprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-135"><a href="#cb22-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   catcount=<span class="st">&quot;</span><span class="va">$catcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-136"><a href="#cb22-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  tagprefix=<span class="st">&quot;</span><span class="va">$tagprefix</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-137"><a href="#cb22-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   tagcount=<span class="st">&quot;</span><span class="va">$tagcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-138"><a href="#cb22-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>  postcount=<span class="st">&quot;</span><span class="va">$postcount</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-139"><a href="#cb22-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    archive=<span class="st">&quot;</span><span class="va">$archive</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-140"><a href="#cb22-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    fonturl=<span class="st">&quot;</span><span class="va">$fonturl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-141"><a href="#cb22-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   textfont=<span class="st">&quot;</span><span class="va">$textfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-142"><a href="#cb22-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>   headfont=<span class="st">&quot;</span><span class="va">$headfont</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-143"><a href="#cb22-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenctxt=<span class="st">&quot;</span><span class="va">$fontenctxt</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-144"><a href="#cb22-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span> fontenchdr=<span class="st">&quot;</span><span class="va">$fontenchdr</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-145"><a href="#cb22-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>    baseurl=<span class="st">&quot;</span><span class="va">$baseurl</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb22-146"><a href="#cb22-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">-V</span>       lang=<span class="st">&quot;pt&quot;</span></span>
<span id="cb22-147"><a href="#cb22-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-148"><a href="#cb22-148" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb22-149"><a href="#cb22-149" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="st">&#39;0,/&lt;table&gt;/{s/&lt;table&gt;/&lt;table class=&quot;blog-header&quot;&gt;/}&#39;</span> posts/index.html <span class="op">&gt;</span> posts.htm</span>
<span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> posts.htm posts/index.html</span>
<span id="cb22-151"><a href="#cb22-151" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="at">-i</span> <span class="st">&#39;s/&lt;table&gt;/&lt;table class=&quot;years&quot;&gt;/g&#39;</span> posts/index.html</span></code></pre></div>
<p>Here the archives index page are ready to be linked to. There is still room for improvement though, as the archives should have a bit more of interaction.</p>
<h3 id="news-feeds">News feeds</h3>
<p>Though news feeds are less important nowadays, many people still use them to follow their favourite blogs. So I think it’s a nice final touch to provide feeds for those who want them. Any way to entice people into reading and returning is valid.</p>
<p>Jilles provided a somewhat limited Atom feed, which never worked correctly for me. I have remade it from scratch, after I learned enough about the format from Wikipedia and other places. I don’t use Jilles’ original atom generator any more.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;?xml version=</span><span class="dt">\&quot;</span><span class="st">1.0</span><span class="dt">\&quot;</span><span class="st"> encoding=</span><span class="dt">\&quot;</span><span class="st">utf-8</span><span class="dt">\&quot;</span><span class="st">?&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;feed xmlns=</span><span class="dt">\&quot;</span><span class="st">http://www.w3.org/2005/Atom</span><span class="dt">\&quot;</span><span class="st">&gt;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;title&gt;</span><span class="va">$site_id</span><span class="st">&lt;/title&gt;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;link rel=</span><span class="dt">\&quot;</span><span class="st">alternate</span><span class="dt">\&quot;</span><span class="st"> type=</span><span class="dt">\&quot;</span><span class="st">text/html</span><span class="dt">\&quot;</span><span class="st"> </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="st">    href=</span><span class="dt">\&quot;</span><span class="va">$baseurl</span><span class="dt">\&quot;</span><span class="st">/&gt;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;link rel=</span><span class="dt">\&quot;</span><span class="st">self</span><span class="dt">\&quot;</span><span class="st"> type=</span><span class="dt">\&quot;</span><span class="st">application/atom+xml</span><span class="dt">\&quot;</span><span class="st"> </span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="st">    href=</span><span class="dt">\&quot;</span><span class="va">$baseurl</span><span class="st">/atom.xml</span><span class="dt">\&quot;</span><span class="st">/&gt;</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;id&gt;</span><span class="va">$baseurl</span><span class="st">&lt;/id&gt;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;subtitle&gt;</span><span class="va">$site_desc</span><span class="st">.&lt;/subtitle&gt;</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;icon&gt;</span><span class="va">$baseurl</span><span class="st">/favicon.ico&lt;/icon&gt;</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;accentColor&gt;dd5500&lt;/accentColor&gt;</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;related layout=</span><span class="dt">\&quot;</span><span class="st">card</span><span class="dt">\&quot;</span><span class="st"> target=</span><span class="dt">\&quot;</span><span class="st">browser</span><span class="dt">\&quot;</span><span class="st">/&gt;</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;updated&gt;</span><span class="va">${update}</span><span class="st">T19:00:00-03:00&lt;/updated&gt;</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;author&gt;</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;name&gt;José Geraldo Gouvêa&lt;/name&gt;</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;email&gt;Lukaslukasmurdock.com&lt;/email&gt;</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;uri&gt;</span><span class="va">$baseurl</span><span class="st">&lt;/uri&gt;</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/author&gt;</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;generator&gt;https://github.com/jggouvea/letmeblog&lt;/generator&gt;</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> atom.xml</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> md <span class="kw">in</span> <span class="kw">`</span><span class="fu">find</span> src/posts <span class="at">-name</span> <span class="dt">\*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-ru</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 12<span class="kw">`;</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="va">dateurl</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">--date</span><span class="op">=</span><span class="kw">`</span><span class="fu">basename</span> <span class="va">$md</span><span class="kw">|</span><span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f</span> 1-3<span class="kw">`</span> <span class="st">&#39;+%Y-%m-%d&#39;</span><span class="va">)</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;title: &quot;</span> <span class="va">$md</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="va">linkurl</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$md</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/.md/.html/&#39;</span><span class="va">)</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="va">tagurl</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$baseurl</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span><span class="va">)</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="va">upurl</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-r</span> <span class="va">$md</span> +%Y-%m-%dT%H:%M:%S<span class="va">)</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="va">category</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;categories:&quot;</span> <span class="at">-A1</span> <span class="va">$md</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;1d&#39;</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="va">teaser</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$md</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;1,/^$/d&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;/^$/,$d&#39;</span> <span class="kw">|</span> <span class="ex">pandoc</span><span class="va">)</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;entry&gt;</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;title&gt;</span><span class="va">$title</span><span class="st">&lt;/title&gt;</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="st">   &lt;id&gt;tag:</span><span class="va">$tagurl</span><span class="st">,</span><span class="va">$dateurl</span><span class="st">:/booklist/map-and-territory&lt;/id&gt;</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;updated&gt;</span><span class="va">$upurl</span><span class="st">&lt;/updated&gt;</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;content type=</span><span class="dt">\&quot;</span><span class="st">html</span><span class="dt">\&quot;</span><span class="st"> xml:lang=</span><span class="dt">\&quot;</span><span class="st">en</span><span class="dt">\&quot;</span><span class="st"> xml:base=</span><span class="dt">\&quot;</span><span class="va">$baseurl</span><span class="dt">\&quot;</span><span class="st">&gt;</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;![CDATA[&lt;a href=</span><span class="dt">\&quot;</span><span class="va">$baseurl</span><span class="st">/</span><span class="va">$linkurl</span><span class="dt">\&quot;</span><span class="st">&gt;&lt;h1&gt;</span><span class="va">$title</span><span class="st">&lt;/h1&gt;&lt;/a&gt; ]]&gt;</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="st">    </span><span class="va">$teaser</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/content&gt;</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;category term=</span><span class="dt">\&quot;</span><span class="va">$category</span><span class="dt">\&quot;</span><span class="st">/&gt;</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;published&gt;</span><span class="va">$dateurl</span><span class="st">&lt;/published&gt;</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/entry&gt;&quot;</span> <span class="op">&gt;&gt;</span> atom.xml</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a><span class="bu">printf</span> <span class="st">&quot;\n&quot;</span> <span class="op">&gt;&gt;</span> atom.xml</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;/feed&gt;&quot;</span> <span class="op">&gt;&gt;</span> atom.xml</span></code></pre></div>
<p>Besides the Atom feed, which may be the most widely used format, I have included a tentative RSS feed generator as well. There is still a lot of room for improvement, but it works:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;?xml version=</span><span class="dt">\&quot;</span><span class="st">1.0</span><span class="dt">\&quot;</span><span class="st"> encoding=</span><span class="dt">\&quot;</span><span class="st">utf-8</span><span class="dt">\&quot;</span><span class="st">?&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;rss version=</span><span class="dt">\&quot;</span><span class="st">2.0</span><span class="dt">\&quot;</span><span class="st">&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;channel&gt;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;title&gt;</span><span class="va">$site_id</span><span class="st">&lt;/title&gt;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;link&gt;</span><span class="va">$baseurl</span><span class="st">&lt;/link&gt;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;description&gt;</span><span class="va">$site_desc</span><span class="st">.&lt;/description&gt;</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="op">&gt;</span> rss.xml</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> md <span class="kw">in</span> <span class="kw">`</span><span class="fu">find</span> src/posts <span class="at">-name</span> <span class="dt">\*</span>.md <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-ru</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 12<span class="kw">`;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="va">dateurl</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">--date</span><span class="op">=</span><span class="kw">`</span><span class="fu">basename</span> <span class="va">$md</span><span class="kw">|</span><span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;-&#39;</span> <span class="at">-f</span> 1-3<span class="kw">`</span> <span class="st">&#39;+%Y-%m-%d&#39;</span><span class="va">)</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="va">title</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;title: &quot;</span> <span class="va">$md</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="va">linkurl</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$md</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/.md/.html/&#39;</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f2,3</span><span class="va">)</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="va">tagurl</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="va">$baseurl</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;/&#39;</span> <span class="at">-f3</span><span class="va">)</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="va">upurl</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-r</span> <span class="va">$md</span> +%Y-%m-%dT%H:%M:%S<span class="va">)</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="va">category</span><span class="op">=</span><span class="va">$(</span><span class="fu">grep</span> <span class="st">&quot;categories:&quot;</span> <span class="at">-A1</span> <span class="va">$md</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;1d&#39;</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-d</span><span class="st">&#39;&quot;&#39;</span> <span class="at">-f2</span><span class="va">)</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="va">teaser</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> <span class="va">$md</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;1,/^$/d&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;/^$/,$d&#39;</span> <span class="kw">|</span> <span class="ex">pandoc</span><span class="va">)</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;item&gt;</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;title&gt;</span><span class="va">$title</span><span class="st">&lt;/title&gt;</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;link&gt;</span><span class="va">$baseurl</span><span class="st">/</span><span class="va">$linkurl</span><span class="st">&lt;/link&gt;</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;description&gt;</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="st">    </span><span class="va">$teaser</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/description&gt;</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/item&gt;&quot;</span> <span class="op">&gt;&gt;</span> rss.xml</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="bu">printf</span> <span class="st">&quot;\n&quot;</span> <span class="op">&gt;&gt;</span> rss.xml</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;&lt;/channel&gt;</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/rss&gt;&quot;</span> <span class="op">&gt;&gt;</span> rss.xml</span></code></pre></div>
<h3 id="sitemap">Sitemap</h3>
<p>Sitemaps are useful to get your website higher SEO ranking. This script is basically the same as Jilles’:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> scripts/site_vars.sh</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="va">sitemap</span><span class="op">=</span><span class="st">&quot;sitemap.xml&quot;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="va">timestamp</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> <span class="at">-u</span> +<span class="st">&quot;%Y-%m-%dT%H:%M:%SZ&quot;</span><span class="va">)</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span><span class="fu"> url()</span> <span class="kw">{</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;&lt;url&gt;&lt;loc&gt;</span><span class="va">${baseurl}</span><span class="st">/</span><span class="va">$1</span><span class="st">&lt;/loc&gt;&lt;lastmod&gt;</span><span class="va">$timestamp</span><span class="st">&lt;/lastmod&gt;&lt;/url&gt;&quot;</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="va">robots</span><span class="op">=</span><span class="kw">`</span><span class="fu">cat</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="st">User-agent: *</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="st">Allow: *</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="st">Sitemap: /sitemap.xml</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="kw">`</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$robots</span><span class="st">&quot;</span> <span class="op">&gt;</span> robots.txt</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="va">header</span><span class="op">=</span><span class="kw">`</span><span class="fu">cat</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;&gt;</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="kw">`</span> </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$header</span><span class="st">&quot;</span> <span class="op">&gt;</span> <span class="va">$sitemap</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> page <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> pages <span class="at">-name</span> <span class="st">&quot;*.html&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/pages\///&#39;</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="va">$(</span><span class="ex">url</span> <span class="va">$page)</span> <span class="op">&gt;&gt;</span> <span class="va">$sitemap</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> post <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> posts <span class="at">-name</span> <span class="st">&quot;*.html&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/posts\///&#39;</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="va">$(</span><span class="ex">url</span> <span class="va">$post)</span> <span class="op">&gt;&gt;</span> <span class="va">$sitemap</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pcat <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> categorias <span class="at">-name</span> <span class="st">&quot;*.html&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/categorias\///&#39;</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="va">$(</span><span class="ex">url</span> <span class="va">$pcat)</span> <span class="op">&gt;&gt;</span> <span class="va">$sitemap</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ptag <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> assuntos <span class="at">-name</span> <span class="st">&quot;*.html&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/assuntos\///&#39;</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="va">$(</span><span class="ex">url</span> <span class="va">$ptag)</span> <span class="op">&gt;&gt;</span> <span class="va">$sitemap</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="bu">printf</span> <span class="st">&quot;&lt;/urlset&gt;\n&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$sitemap</span></span></code></pre></div>
<h2 id="uploading">Uploading</h2>
<p>After done the compilation, you now have to upload the generated content to your webserver, for which you can use your trusty FTP transfer utility (like <code>ncftp</code>, <code>lftp</code>, FileZilla etc.), or some <code>rsync</code> spell.</p>
<p>I have chosen to do that manually, instead of scripting, because of bad misfortunes I had in the past, using buggy <code>rsync</code> spells which, instead of uploading my contents to an empty directory in the cloud, instead <em>deleted</em> my local content, an unforeseen way to make the two places exact “mirrors” of each other…</p>
<p>If you have too many images, this upload will take very long (my initial commit took almost one full hour), but for text files it is very fast. Future uploads will be faster, too.</p>
<p>My preferred upload method is the mirroring command from <code>lftp</code>:</p>
<p><code>mirror -R localdir remotedir</code></p>
<p>Which you will invoke <em>after</em> logging into your FTP server using <code>lftp</code> and changing your local directory to your build root.</p>
<p>If you didn not change into the root folder before you logged in, you can still do it with the command <code>lcd</code>, which takes the full path (unless changing into a subdirectory of the current).</p>
<p>In <em>my case</em>, as an example, I do this:</p>
<pre><code>lftp -u myuser ftp.mydomain.com.br
cd ..
mirror -R -x templates -x src -x scripts public_html www</code></pre>
<p>One good thing about the “mirror” command from <code>lftp</code> is that it will only transfer files which have changed, which means it will probably re-upload your entire set of HTML, as well as any files you have edited, but <em>not</em> if you add the <code>--ignore-time</code> switch, which instructs <code>lftp</code> to only upload files that have been added or which have changed in bytesize.</p>
<p>Recompiling your entire blog with the <code>do_posts.sh</code> script, for instance, will change the HTML files timestamp, but if no change has been actually made do the templates or to the contents, the size in bytes may still be the same. The <code>--ignore-time</code> switch will prevent you from re-upload everything, saving bandwidth and time.</p>
<h2 id="to-be-added">To be added</h2>
<p><code>letmeblog</code> is quite complete, at this point, as there is little I am <em>capable</em> of adding. However, some useful features it could use, and which you could help me build, are:</p>
<ul>
<li>Pagination, or “page navigation” for large content lists;</li>
<li>Local search (a simple <code>grep</code> would suffice);</li>
<li>Access counter.</li>
</ul>
<p>Some features are going to be implemented or improved as soon as I find enough documentation:</p>
<ul>
<li>Improved <code>robots.txt</code>;</li>
<li>Improved <code>.htaccess</code>;</li>
<li>Fully functional RSS feed;</li>
</ul>
<p>Other features are already in planning, but might be delayed, as they are too specific for my needs:</p>
<ul>
<li>PDF and EPUB generation for sets of files (“anthologies”);</li>
<li>CSS editing based on font embedding (currently <code>letmeblog</code> wants you to manually edit your CSS files replacing font declarations if you change the font embedding link);</li>
<li>Social network links.</li>
</ul>
<p>You are invited to help improve <code>letmeblog</code> as you can.</p>
<h1 id="conclusion">Conclusion</h1>
<p>If you like this, visit me at <a href="http://letraseletricas.blog.br" class="uri">http://letraseletricas.blog.br</a>, find my social network places, and help spread the word about my work as a fiction writer and translator.</p>
<p>Thanks for reading up to this point. I hope you can produce your own blog using my tool. But if you don’t, remember the old adage of the GNU gurus:</p>
<blockquote>
<p>THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.</p>
</blockquote>
<blockquote>
<p>IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.</p>
</blockquote>
<h1 id="legalese">Legalese</h1>
<p>Scripts licensed under the <a href="https://mit-license.org">MIT/Expat</a>.</p>
<p>Script <code>do_sitemap.sh</code>: Copyright © 1999-2020 by Jilles van Gurp</p>
<p>Other scripts and templates Copyright © 2021 José Geraldo Gouvêa</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Well, <em>in theory</em> you can do that, but Gutenberg goes out of its way to corrupt the content you paste. You actually spend more time reviewing your post than you would if you had just written it in Gutenberg already.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>That was something that hurt me for many years: I had to keep two versions of my content, one online, in the blog, and one offline, usually in OpenDocument format (but I actually used a smattering of different formats — like LaTeX, LyX, RTF, HTML, plain text, Asciidoc and even Markdown. And it was never easy to keep tabs on versions and to keep backups up to date.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>I have actually tested the script with <code>zsh</code> and it worked just fine. In fact, the early development was in <code>zsh</code>. I only moved back to <code>bash</code> because I noticed that it is more strict in syntax validation, which means that, unless I use “bashisms”, a script that was developed and tested under <code>bash</code> is more likely to work with well under <code>zsh</code> than the other way around.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>I am not sure whether the script will work with non-gnu <code>sed</code>, but, afaik, it probably will.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>For the purposes of this document, the term “build root” will be used for the working directory where you will compile your blog. If you are in Linux, like me, it’s useful to put the scripts and their content in a directory read by your local http server, so you can develop the blog live, before you upload it.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6" role="doc-endnote"><p>Don’t mind the thumbnails, they are already honoured by the scripts if you include a “coverImage” directive in your <code>yaml</code> metadata.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7" role="doc-endnote"><p>I don’t particularly love the Open Font Library, but… hey! They aren’t Google!<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8" role="doc-endnote"><p>The script will spit some erros during its run, as it encounters files not yet categorised. These errors will not appear any more after every post has at least one category.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9" role="doc-endnote"><p>The script will spit some erros during its run, as it encounters files not yet tagged. These errors will not appear any more after every post has at least one tag.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10" role="doc-endnote"><p>Though the <code>atom.xml</code> and <code>sitemap.xml</code> link to html files, in practice they are produced by processing Markdown inputs, like everything else.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
